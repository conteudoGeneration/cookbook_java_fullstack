<h1>Fetch API</h1>



A **Fetch API** do JavaScript √© uma interface moderna que permite realizar **requisi√ß√µes HTTP ass√≠ncronas** para APIs hospedadas em servidores, diretamente a partir de **navegadores web**.

Ela simplifica o trabalho com opera√ß√µes ass√≠ncronas por meio de **Promises**, proporcionando maior flexibilidade, melhor legibilidade do c√≥digo e mais possibilidades de personaliza√ß√£o no consumo de APIs.

<br />

<h2>1. Fun√ß√µes Ass√≠ncronas</h2>



As Fun√ß√µes **S√≠ncronas** s√£o executadas de forma **sequencial e bloqueante**, ou seja, cada instru√ß√£o precisa ser totalmente conclu√≠da antes que a pr√≥xima seja iniciada. Se uma fun√ß√£o s√≠ncrona realiza uma opera√ß√£o demorada, como um c√°lculo pesado, todo o fluxo do programa fica parado at√© que essa fun√ß√£o termine. 

> No dia a dia, √© como uma fila de atendimento com apenas um caixa: a pr√≥xima pessoa s√≥ √© atendida depois que a anterior conclui todo o processo.

J√° as fun√ß√µes **ass√≠ncronas** permitem que opera√ß√µes demoradas sejam executadas em segundo plano, **sem bloquear a execu√ß√£o do restante do c√≥digo**. Enquanto uma tarefa ass√≠ncrona aguarda seu resultado, o programa pode continuar executando outras instru√ß√µes. Quando o resultado estiver dispon√≠vel, ele √© tratado posteriormente, por meio de **Promises** ou **async/await**. 

> Usando a mesma analogia, √© como retirar uma senha: voc√™ pode realizar outras atividades enquanto espera, e s√≥ retorna quando for chamado, tornando a aplica√ß√£o mais eficiente e responsiva, especialmente em opera√ß√µes como requisi√ß√µes HTTP, leitura de arquivos ou temporizadores.

As **Fun√ß√µes ass√≠ncronas** s√£o especialmente √∫teis para opera√ß√µes que demandam tempo, como:

- Requisi√ß√µes HTTP
- Acesso a bancos de dados
- Leitura de arquivos

<br />

<h3>1.1. Promise</h3>



Uma **Promise** √© um objeto JavaScript utilizado para **processamento ass√≠ncrono**. Ela representa um valor que pode estar dispon√≠vel agora, no futuro ou nunca, em caso de erro.

Na pr√°tica, uma Promise funciona como um ‚Äúrepresentante‚Äù de um valor que ainda n√£o est√° dispon√≠vel no momento da cria√ß√£o. Isso permite associar m√©todos para tratar o sucesso ou a falha da opera√ß√£o ass√≠ncrona.

Uma Promise pode assumir tr√™s estados:

<div align="center"><img src="https://i.imgur.com/CoxH7Yw.png" title="source: imgur.com" /><figcaption><i>Estados de uma Promise</i></figcaption></div>

  - **pending (pendente):** estado inicial, ainda n√£o resolvida nem rejeitada
  - **fulfilled (resolvida):** opera√ß√£o conclu√≠da com sucesso
  - **rejected (rejeitada):** opera√ß√£o conclu√≠da com erro

<br />

  **Sintaxe**

```ts
  new Promise((resolve, reject) => {
    // l√≥gica ass√≠ncrona
  });
```

- **resolve:** fun√ß√£o utilizada para retornar o resultado esperado
- **reject:** fun√ß√£o utilizada para retornar um erro

<br />

<div align="left"><img src="https://i.imgur.com/r9lrbPG.png" title="source: imgur.com" width="30px"/> <a href="https://developer.mozilla.org/pt-BR/docs/Web/JavaScript/Reference/Statements/async_function" target="_blank"><b>Documenta√ß√£o: Fun√ß√µes Ass√≠ncronas</b></a></div>

<div align="left"><img src="https://i.imgur.com/r9lrbPG.png" title="source: imgur.com" width="30px"/> <a href="https://developer.mozilla.org/pt-BR/docs/Web/JavaScript/Reference/Global_Objects/Promise" target="_blank"><b>Documenta√ß√£o: Promise</b></a></div>

<br />

<h2>2. M√©todo Fetch()</h2>



O m√©todo `fetch()` √© utilizado para enviar uma requisi√ß√£o HTTP a uma URL espec√≠fica. Ele retorna uma **Promise**, que ser√° resolvida com um objeto do tipo `Response`.

**Sintaxe**

```javascript
fetch(url)
  .then(response => {
    // Tratamento da resposta
  })
  .catch(error => {
    // Tratamento de erro
  });
```

**Onde:**

- **fetch(url):** realiza uma requisi√ß√£o HTTP (por padr√£o, do tipo GET) para recuperar um recurso do servidor.
- **then():** executado quando a resposta √© recebida com sucesso.
- **catch():** executado quando ocorre algum erro, como falha de conex√£o ou erro de execu√ß√£o.

<br />

> [!IMPORTANT]
>
> O `fetch()` **n√£o lan√ßa erro automaticamente** para status HTTP como 404 ou 500. √â uma boa pr√°tica verificar `response.ok`.

<br />

Para acessar os dados retornados pela API, utilizamos o m√©todo `json()`, que converte o corpo da resposta em um objeto JavaScript no formato JSON.

**Sintaxe**

```js
resposta.json()
```

Ao converter a resposta da requisi√ß√£o para o formato JSON, receberemos algo semelhante ao exemplo abaixo:

```json
{
  "login": "conteudoGeneration",
  "avatar_url": "https://avatars.githubusercontent.com/u/62150036?v=4",
  "url": "https://api.github.com/users/conteudoGeneration",
  "html_url": "https://github.com/conteudoGeneration",
  "public_repos": 36,
  "followers": 555,
  "following": 2,
  "created_at": "2020-03-13T15:38:51Z",
  "updated_at": "2023-12-12T13:46:14Z"
}

```

Esses dados podem ser utilizados para dinamizar e automatizar as se√ß√µes da sua aplica√ß√£o web.

<br />

<div align="left"><img src="https://i.imgur.com/r9lrbPG.png" title="source: imgur.com" width="30px"/> <a href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API" target="_blank"><b>Documenta√ß√£o: Fetch API</b></a></div>

<div align="left"><img src="https://i.imgur.com/r9lrbPG.png" title="source: imgur.com" width="30px"/> <a href="https://developer.mozilla.org/en-US/docs/Web/API/Request/json" target="_blank"><b>Documenta√ß√£o: M√©todo json()</b></a></div>

<br />

<h3>2.1. Fetch API com async/await</h3


Como o m√©todo `fetch()` retorna uma **Promise**, podemos utilizar a sintaxe **async/await**, que torna o c√≥digo mais leg√≠vel, organizado e com um fluxo de execu√ß√£o semelhante ao c√≥digo s√≠ncrono.

- **async**: indica que a fun√ß√£o √© ass√≠ncrona e que ela sempre retornar√° uma Promise.
- **await**: pausa a execu√ß√£o da fun√ß√£o at√© que a Promise seja resolvida ou rejeitada.

üìå A palavra-chave `await` **s√≥ pode ser utilizada dentro de fun√ß√µes declaradas com `async`**.

**Sintaxe**

```js
async function nomeDaFuncao() {
  await funcaoQueRetornaPromise();
}
```

<br />

<div align="left"><img src="https://i.imgur.com/r9lrbPG.png" title="source: imgur.com" width="30px"/> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function" target="_blank"><b>Documenta√ß√£o: Fun√ß√µes Ass√≠ncronas - async</b></a></div>

<div align="left"><img src="https://i.imgur.com/r9lrbPG.png" title="source: imgur.com" width="30px"/> <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await" target="_blank"><b>Documenta√ß√£o: Fun√ß√µes Ass√≠ncronas - await</b></a></div>

<br />

<img src="https://i.imgur.com/zCTwZAz.png" title="source: imgur.com" width="5%"/>**Exemplo:**

```javascript
async function consultar() {
    try {
        const resposta = await fetch('https://blogpessoal.onrender.com/temas/1');

        if (!resposta.ok) {
            throw new Error('Erro na requisi√ß√£o');
        }

        const respostaJson = await resposta.json();
        console.log(respostaJson);
        
    } catch (error) {
        console.error(error);
    }
}
```

### Analisando o exemplo:

- A fun√ß√£o foi declarada com a palavra-chave **`async`**, permitindo o uso de `await`.
- O m√©todo **`fetch()`** foi executado com `await`, aguardando a resposta da requisi√ß√£o HTTP.
- A verifica√ß√£o **`resposta.ok`** garante que erros HTTP (como 404 ou 500) sejam tratados corretamente antes do processamento dos dados.
- O m√©todo **`json()`** tamb√©m utiliza `await`, pois ele retorna uma Promise contendo os dados convertidos para JSON.
- A estrutura **`try...catch`** √© utilizada para capturar e tratar erros de forma adequada.

<br />

> [!TIP]
>
> ### Tratamento de Erros HTTP
>
> O objeto `Response`, retornado pelo m√©todo `fetch()`, possui a propriedade:
>
> ```js
> response.ok
> ```
>
> Essa propriedade indica se a requisi√ß√£o HTTP foi bem-sucedida:
>
> - `true` ‚Üí quando o status da resposta est√° entre **200 e 299**
> - `false` ‚Üí para qualquer outro status HTTP
>
> üìå Essa √© a **forma mais simples** de identificar erros HTTP ao trabalhar com a Fetch API.
>
> Por esse motivo, realizamos a seguinte verifica√ß√£o no c√≥digo acima:
>
> ```js
> if (!resposta.ok) {
>     throw new Error('Erro na requisi√ß√£o');
> }
> ```
>
> Essa checagem garante que apenas respostas v√°lidas da API sejam processadas, interrompendo o fluxo da aplica√ß√£o caso ocorra algum erro na requisi√ß√£o.
>
> <br />
>
> ### Verificando um status HTTP espec√≠fico
>
> Caso seja necess√°rio tratar um erro espec√≠fico, podemos utilizar a propriedade:
>
> ```js
> response.status
> ```
>
> Ela retorna o **c√≥digo HTTP exato** da resposta.
>
> **Exemplo:**
>
> ```js
> if (resposta.status === 404) {
>     throw new Error('Recurso n√£o encontrado');
> }
> ```
>
> Esse tipo de verifica√ß√£o √© √∫til para criar mensagens de erro mais claras e realizar tratamentos personalizados de acordo com o tipo de falha retornada pela API.

<br />

A **Fetch API**, combinada com **Promises** e a sintaxe **async/await**, oferece uma abordagem moderna, clara e eficiente para o consumo de APIs no JavaScript. Essa pr√°tica √© amplamente adotada no mercado e √© fundamental para o desenvolvimento de aplica√ß√µes web din√¢micas e integradas com servi√ßos externos.

Agora que os conceitos foram apresentados, o pr√≥ximo passo √© aplicar esse conhecimento no **consumo da API do GitHub**, exibindo dados de forma din√¢mica na aplica√ß√£o.

------

## üîë Pontos-chave

1. A **Fetch API** do JavaScript √© uma interface moderna que permite realizar **requisi√ß√µes HTTP ass√≠ncronas** para API's hospedadas em servidores, diretamente a partir de **navegadores web**.
2. O m√©todo **`fetch()`** retorna uma **Promise**, que representa o resultado futuro da requisi√ß√£o HTTP e, quando resolvida, fornece um objeto do tipo **`Response`**.
3. **Promises** s√£o objetos que representam **opera√ß√µes ass√≠ncronas**, ou seja, a√ß√µes que n√£o s√£o conclu√≠das imediatamente e cujo resultado estar√° dispon√≠vel em um momento posterior.
4. Uma **Promise** pode assumir tr√™s estados:
   - **pending**: a opera√ß√£o ainda est√° em andamento;
   - **fulfilled**: a opera√ß√£o foi conclu√≠da com sucesso;
   - **rejected**: a opera√ß√£o falhou e gerou um erro.
5. **Fun√ß√µes ass√≠ncronas** podem ser declaradas de forma semelhante √†s fun√ß√µes s√≠ncronas, utilizando a palavra-chave **`async`**, o que permite o uso do `await` em seu interior.
6. A palavra-chave **`await`** faz com que a execu√ß√£o da fun√ß√£o seja temporariamente pausada at√© que a **Promise** seja resolvida, tornando o c√≥digo mais leg√≠vel e pr√≥ximo de uma escrita sequencial.
7. O m√©todo **`fetch()` n√£o lan√ßa erros automaticamente** quando a resposta HTTP possui status **4xx** ou **5xx**; nesses casos, a Promise ainda √© resolvida normalmente.
8. Para identificar se a resposta HTTP foi bem-sucedida, deve-se utilizar a propriedade **`response.ok`**, que retorna `true` para status entre **200 e 299**.
9. O m√©todo **`response.json()`** converte o corpo da resposta para um objeto JavaScript e, por se tratar de uma opera√ß√£o ass√≠ncrona, **retorna uma Promise**, que deve ser tratada com `await` ou `then()`.

<br />
<br />

<div align="left"><a href="README.md"><img src="https://i.imgur.com/XMgF3gl.png" title="source: imgur.com" width="3%"/>Voltar</a></div>