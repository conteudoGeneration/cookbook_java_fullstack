<h1>Projeto Blog Pessoal - Criar o Script Service</h1>



Vamos implementar a **Service**, a segunda etapa do processo de integra√ß√£o entre o **Frontend** e o **Backend**.

Uma **Service** geralmente √© um **script TypeScript**, que cont√©m **fun√ß√µes ass√≠ncronas** respons√°veis por consumir recursos de uma API ou de outras fontes externas de dados. Essas fun√ß√µes normalmente realizam opera√ß√µes como **consultar, criar, atualizar ou deletar dados** em uma API e, em seguida, atualizar o **estado dos componentes React**, retornando os resultados do consumo do Backend.

> **Objetivos principais de uma Service:**
>
> - **Separar responsabilidades:** mant√©m a l√≥gica de comunica√ß√£o com o Backend isolada dos componentes, deixando o c√≥digo mais organizado e f√°cil de manter.
> - **Reutiliza√ß√£o de c√≥digo:** permite que a mesma l√≥gica seja utilizada em diferentes partes da aplica√ß√£o, evitando duplica√ß√£o e promovendo **Clean Code**.
> - **Facilitar manuten√ß√£o:** centraliza o consumo de APIs, tornando mais simples atualizar endpoints, headers ou regras de neg√≥cio sem precisar alterar v√°rios componentes.

<br />

> [!IMPORTANT]
>
> Em projetos **React**, √© comum criar **Services** n√£o apenas para consumir APIs do pr√≥prio Backend, mas tamb√©m para **interagir com APIs de terceiros** ou executar **opera√ß√µes complexas que envolvem diversas regras de neg√≥cio**, como, por exemplo: enviar e-mails, gerar relat√≥rios em PDF, gravar arquivos na nuvem, entre outras.
>
> Ao separar essas responsabilidades em **Services**, o **Frontend se mant√©m mais limpo e organizado**, e a l√≥gica de neg√≥cio pode ser reutilizada de forma consistente em diferentes partes da aplica√ß√£o.

<br />

No contexto do nosso **Projeto Blog Pessoal**, a Service ser√° respons√°vel apenas por **conectar com o Frontend √†s Models do Backend**, garantindo que todas as opera√ß√µes com dados sejam tratadas de forma consistente e segura.

<br />

<h2>üë£ Passo 01 - Instalar a Biblioteca Axios</h2>



Vamos instalar a Biblioteca **Axios** no Projeto **Blog Pessoal**:

1. Para instalar o **Axios**, abra o Terminal do Visual Studio Code
2. Digite o comando abaixo:

```bash
npm install axios
```

3. Ap√≥s a instala√ß√£o, ser√° exibida uma mensagem semelhante a imagem abaixo:

<div align="center"><img src="https://i.imgur.com/26KFfj3.png" title="source: imgur.com" /></div>

<br />

> [!IMPORTANT]
>
> **A vers√£o atual do Axios pode ser diferente da vers√£o exibida na imagem acima**.

<br />

<div align="left"><img src="https://i.imgur.com/A94hGdN.png" title="source: imgur.com" width="4%"/> <a href="https://axios-http.com/" target="_blank"><b>Axios - Documenta√ß√£o Oficial</b></a></div>

<div align="left"><img src="https://i.imgur.com/A94hGdN.png" title="source: imgur.com" width="4%"/> <a href="https://www.npmjs.com/package/axios" target="_blank"><b>Axios - Documenta√ß√£o de Instala√ß√£o e Tutorial</b></a></div>

<br />

<h2>üë£ Passo 02 - Criar a pasta Services</h2>



Antes de criarmos o script **Service**, vamos criar a pasta **services**:

<br />

> [!IMPORTANT]
>
> **Os nomes das pastas sempre devem ser escritos com letras min√∫sculas, para evitar conflitos no momento do Deploy da aplica√ß√£o React.**

<br />

1. Na pasta **src**, clique com o bot√£o direito do mouse e clique na op√ß√£o **New Folder** (Nova Pasta).
2. O nome da pasta ser√° **services**. Ap√≥s digitar o nome da pasta, pressione a tecla **enter** do seu teclado para concluir.
3. Ao concluir, voc√™ deve estar a seguinte estrutura dentro da pasta **src**:

<div align="center"><img src="https://i.imgur.com/FALWCQ6.png" title="source: imgur.com" /></div>

<br>

<h2><img src="https://i.imgur.com/izFuHID.png" title="source: imgur.com" width="4%"/>Passo 03 - Criar o Script Service</h2>



Vamos criar o Script **Service**:

1. Na pasta **services**, clique com o bot√£o direito do mouse e clique na op√ß√£o **New File** (Novo Arquivo).
2. O nome do arquivo ser√° **Service.ts**. Ap√≥s digitar o nome do arquivo, pressione a tecla **enter** do seu teclado para concluir.
3. Ao concluir, voc√™ deve estar a seguinte estrutura dentro da pasta **services**:

<div align="center"><img src="https://i.imgur.com/Tsb2Orr.png" title="source: imgur.com" /></div>

<br />

> [!NOTE]
>
> **Diferente dos arquivos que definem um Componentes React, o arquivo que define uma Service utilizar√° a extens√£o .ts (TypeScript), ao inv√©s de utilizar a extens√£o .tsx (React).**

<br />

4. Na sequ√™ncia vamos adicionar o c√≥digo abaixo no Script Service:

<div align="center"><img src="https://i.imgur.com/pnYx3vD.png" title="source: imgur.com" /></div>

**Vamos analisar o nosso c√≥digo:**

**Linha 01:** Importamos a biblioteca **Axios**, que ser√° utilizada para realizar requisi√ß√µes HTTP.

**Linhas 03 a 05:** Criamos uma **inst√¢ncia do Axios**, chamada **`api`**, utilizando o m√©todo **`create()`**. Nesse m√©todo, passamos um objeto de configura√ß√£o que inclui a propriedade **`baseURL`**.

**Linha 05:** A propriedade **`baseURL`** deve receber o **link do deploy do Backend do seu Blog Pessoal** (destacado por uma seta verde na imagem). Isso significa que todas as requisi√ß√µes feitas atrav√©s dessa inst√¢ncia do Axios utilizar√£o esse endere√ßo como **prefixo para os endpoints**, garantindo consist√™ncia e evitando repetir a URL completa em cada requisi√ß√£o.

**Exemplo de URL de requisi√ß√£o:**

```typescript
https://blogpessoal.onrender.com/postagens
```

**onde:**

- **https://blogpessoal.onrender.com** ‚Üí endere√ßo do deploy do Backend (prefixo da URL)
- **/postagens** ‚Üí endpoint espec√≠fico que ser√° consumido

Dessa forma, sempre que utilizarmos a inst√¢ncia **`api`** para enviar requisi√ß√µes, o Axios **concatena automaticamente a `baseURL` com o endpoint**, simplificando o c√≥digo e evitando erros de digita√ß√£o na URL.

<br />

> **Como obter o link do Deploy no Render?**
>
> 1. Acesse o site do **[Render](https://render.com)**
> 2. Fa√ßa o login
> 3. Acesse o Dashboard do Render
> 4. Clique no **WebService blogpessoal** 
> 5. Copie o link, indicado na imagem abaixo, clicando no bot√£o **Copy** <img src="https://i.imgur.com/Tkpz6wB.png" title="source: imgur.com" width="4%"/>:
>
> <div align="center"><img src="https://i.imgur.com/TlY7nP5.png" title="source: imgur.com" /></div>
>
> 6. Adicione o link copiado na propriedade **baseURL**

<br />

| <img src="https://i.imgur.com/vVDBDG0.png" title="source: imgur.com" width="80px"/> | <div align="left"><div align="left"> **ALERTA DE BSM:** *Mantenha a Aten√ß√£o aos Detalhes ao adicionar o endere√ßo do deploy na propriedade baseURL. Insira o endere√ßo do Deploy do seu Backend. O endere√ßo utilizado no Cookbook √© apenas um exemplo*.</div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

**Linhas 07 a 10:** Constru√≠mos e exportamos a fun√ß√£o ass√≠ncrona **`cadastrarUsuario`**, respons√°vel por cadastrar um novo usu√°rio na aplica√ß√£o.

**Linha 07:** Criamos uma **Arrow Function ass√≠ncrona (`async`)**, que recebe tr√™s argumentos:

- **`url`**: string que representa o endpoint da API para a requisi√ß√£o **POST**. Esta URL ser√° anexada √† **`baseURL`** definida na inst√¢ncia do Axios.
- **`dados`**: estado que cont√©m as informa√ß√µes do usu√°rio a serem enviadas no corpo da requisi√ß√£o **POST** e persistidas no backend.
- **`setDados`**: fun√ß√£o que atualiza o estado do usu√°rio (criado no componente Cadastro) com os dados retornados pela API, incluindo, por exemplo, o **id gerado automaticamente pelo banco de dados**.

**Linha 08:** Realizamos a requisi√ß√£o **POST** utilizando a fun√ß√£o ass√≠ncrona **`post()`** do Axios, enviando o objeto **`dados`** para o endpoint definido em **`url`**. A palavra reservada **`await`** garante que a execu√ß√£o aguarde a conclus√£o da requisi√ß√£o antes de continuar.

<br />

> [!IMPORTANT]
>
> Todos os m√©todos do Axios (`get`, `post`, `put`, `delete`) retornam **Promises**. Isso significa que, mesmo que o c√≥digo pare√ßa s√≠ncrono com o uso de **async/await**, a requisi√ß√£o HTTP est√° sendo processada em **segundo plano**, permitindo que a aplica√ß√£o continue funcionando normalmente enquanto aguarda a resposta.

<br />

**Linha 09:** Ap√≥s a requisi√ß√£o ser conclu√≠da, a resposta da API √© armazenada na vari√°vel **`resposta`**. Em seguida, chamamos **`setDados(resposta.data)`**, atualizando o estado do usu√°rio com os dados retornados pelo backend, garantindo que a aplica√ß√£o tenha o **id** e demais informa√ß√µes geradas pelo servidor.

**Linhas 12 a 15:** Constru√≠mos e exportamos a fun√ß√£o ass√≠ncrona **`login`**, respons√°vel por autenticar o usu√°rio na aplica√ß√£o.

**Linha 12:** Criamos uma **Arrow Function ass√≠ncrona (`async`)** que recebe tr√™s argumentos:

- **`url`**: string do endpoint da API que receber√° a requisi√ß√£o **POST** para login.
- **`dados`**: estado com as informa√ß√µes de autentica√ß√£o do usu√°rio (usu√°rio e senha), que ser√£o validadas pelo backend.
- **`setDados`**: fun√ß√£o que atualiza o estado do usu√°rio (criado no **AuthContext**) com os dados retornados pela API, incluindo **id, nome, foto e token JWT**. A senha ser√° retornada vazia.

**Linha 13:** Realizamos a requisi√ß√£o **POST** usando a inst√¢ncia **`api`** do Axios, enviando os dados contidos em **`dados`**. A palavra **`await`** garante que a execu√ß√£o espere a resposta da API antes de continuar.

**Linha 14:** A resposta da API √© armazenada na vari√°vel **`resposta`** e, em seguida, chamamos **`setDados(resposta.data)`**, atualizando o estado global com os dados do usu√°rio autenticado.

<br />

> [!IMPORTANT]
>
> **Observe que o c√≥digo de `cadastrarUsuario`** √© muito semelhante ao c√≥digo de **`login`**, mudando apenas o nome declarativo. Isso ocorre porque ambas as fun√ß√µes possuem **escopos e estruturas similares**, mas t√™m **responsabilidades diferentes**, portanto n√£o devem ser trocadas.

<br />

<div align="left"><img src="https://i.imgur.com/A94hGdN.png" title="source: imgur.com" width="4%"/> <a href="https://github.com/axios/axios#creating-an-instance" target="_blank"><b>Axios - Criando uma inst√¢ncia</b></a></div>

<div align="left"><img src="https://i.imgur.com/r9lrbPG.png" title="source: imgur.com" width="30px"/> <a href="https://developer.mozilla.org/pt-BR/docs/Web/JavaScript/Reference/Statements/async_function" target="_blank"><b>Documenta√ß√£o: Fun√ß√µes Ass√≠ncronas</b></a></div>

<div align="left"><img src="https://i.imgur.com/r9lrbPG.png" title="source: imgur.com" width="30px"/> <a href="https://developer.mozilla.org/pt-BR/docs/Web/JavaScript/Reference/Global_Objects/AsyncFunction" target="_blank"><b>Documenta√ß√£o: Async</b></a></div>

<div align="left"><img src="https://i.imgur.com/r9lrbPG.png" title="source: imgur.com" width="30px"/> <a href="https://developer.mozilla.org/pt-BR/docs/Web/JavaScript/Reference/Operators/await" target="_blank"><b>Documenta√ß√£o: Await</b></a></div>

<br />

<div align="left"><img src="https://i.imgur.com/JACNZiR.png" title="source: imgur.com" width="5%"/> <a href="https://github.com/rafaelq80/blogpessoal_react_v19/tree/08_Services" target="_blank"><b>C√≥digo fonte do projeto</b></a></div>

<br /><br />

<div align="left"><a href="README.md"><img src="https://i.imgur.com/XMgF3gl.png" title="source: imgur.com" width="3%"/>Voltar</a></div>
