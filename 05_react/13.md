<h1>Introdu√ß√£o ao Axios</h1>



Como vimos em conte√∫dos anteriores, enquanto o **Frontend √© a parte visual da aplica√ß√£o**, exibindo dados recebidos do Backend em um formato mais amig√°vel, permitindo que as pessoas usu√°rias interajam com esses dados, o **Backend fica respons√°vel por trabalhar com as regras de neg√≥cio da aplica√ß√£o** e a manipula√ß√£o desses dados junto ao banco de dados.

Entretanto, voc√™ pode ter se deparado com a seguinte quest√£o: **Como o Frontend e o Backemd se comunicam?**

A resposta para esta pergunta √©: atrav√©s das **Bibliotecas de Comunica√ß√£o HTTP**.

As **Bibliotecas de Comunica√ß√£o HTTP** permitem que uma aplica√ß√£o Frontend, fa√ßa Requisi√ß√µes HTTP para uma API (Backend) e receba Respostas HTTP, com os respectivos dados e Status, assim como fizemos no Insomnia, durante desenvolvimento do Backend, com a diferen√ßa de fazer estas requisi√ß√µes de uma forma mais automatizada. 

**Essas Bibliotecas s√£o respons√°veis por lidar com a comunica√ß√£o entre o Frontend e o Backend da aplica√ß√£o, permitindo que o usu√°rio visualize e interaja com os dados que est√£o armazenados no servidor.**

No universo JavaScript, uma das formas mais populares de enviar Requisi√ß√µes HTTP para uma API √© a interface **Fetch API**. No universo React, a Biblioteca mais utilizada √© o **Axios**. Cada uma destas duas solu√ß√µes, tem suas pr√≥prias vantagens e desvantagens e, em geral, s√£o utilizadas para realizar as 4 opera√ß√µes do CRUD (Create, Read, Update, Delete), utilizando os 4 verbos principais do Protocolo HTTP (GET, POST, PUT e DELETE), consumindo os  endpoints do Backend.

Um elemento que ambas as solu√ß√µes citadas tem em comum, √© que ambas utilizam o conceito de **Fun√ß√µes Ass√≠ncronas**, que no JavaScript/TypeScript s√£o implementados atrav√©s de um objeto chamado **Promise**, para realizar as Requisi√ß√µes HTTP e lidar com as Respostas das Requisi√ß√µes de forma **Ass√≠ncrona**, ou seja, por meio de **Fun√ß√µes As√≠ncronas**, que implementam o conceito do processamento em segundo plano. 

> **Fun√ß√µes Ass√≠ncronas** s√£o fun√ß√µes que podem ser executadas em segundo plano, enquanto o restante do c√≥digo continua sua execu√ß√£o. Essas fun√ß√µes s√£o especialmente √∫teis para opera√ß√µes que podem levar algum tempo para serem conclu√≠das, como Requisi√ß√µes HTTP para API's ou acesso √† Bancos de dados.
>
> **Promise:** √â um objeto JavaScript/TypeScript utilizado para o **Processamento Ass√≠ncrono**. Na pr√°tica, uma Promise √© uma promessa, que representa um valor que pode estar dispon√≠vel agora, no futuro ou nunca (erro). 
>
> Uma **Promise** √© como um "procurador" para um valor que n√£o √© necessariamente conhecido quando a promessa √© criada. Isso permite a associa√ß√£o de m√©todos de tratamento para eventos da a√ß√£o ass√≠ncrona num caso eventual de sucesso ou de falha. Isto permite que os m√©todos ass√≠ncronos retornem valores como m√©todos s√≠ncronos: ao inv√©s do valor final, o m√©todo ass√≠ncrono retorna uma promessa de que receber√° o valor em algum momento no futuro.
>
> Observe na imagem abaixo, que uma **Promise** possui tr√™s estados:
>
> <div align="center"><img src="https://i.imgur.com/CoxH7Yw.png" title="source: imgur.com" /><figcaption><i>Estados de uma Promise</i></figcaption></div>
>
>   - **pending** (pendente): Estado inicial, que n√£o foi nem resolvida e nem rejeitada.
> - **fulfilled** (resolvida): sucesso na opera√ß√£o.
> - **rejected** (rejeitado):  falha na opera√ß√£o.
>
> Abaixo, vemos como criar uma Promise
>
>   **Sintaxe:**
>
>   ```ts
>   new Promise( ( resolve, reject ) => { } )
>   ```
>
>   - **resolve**: fun√ß√£o, geralmente uma **Arrow Function**, que ser√° utilizada para retornar o resultado da Promise.
>   - **reject**: fun√ß√£o, geralmente uma **Arrow Function**, que ser√° utilizada para para retornar o erro da Promise.
>
> <br>
>
> <div align="left"><img src="https://i.imgur.com/r9lrbPG.png" title="source: imgur.com" width="30px"/> <a href="https://developer.mozilla.org/pt-BR/docs/Web/JavaScript/Reference/Statements/async_function" target="_blank"><b>Documenta√ß√£o: Fun√ß√µes Ass√≠ncronas</b></a></div>
>
> <div align="left"><img src="https://i.imgur.com/r9lrbPG.png" title="source: imgur.com" width="30px"/> <a href="https://developer.mozilla.org/pt-BR/docs/Web/JavaScript/Reference/Global_Objects/Promise" target="_blank"><b>Documenta√ß√£o: Promise</b></a></div>
>
> <br>

Na pr√°tica, Isso significa que uma Requisi√ß√£o HTTP √© feita em segundo plano, enquanto a aplica√ß√£o continua  funcionando normalmente, sem bloquear a aplica√ß√£o. Quando a Resposta HTTP √© recebida, a fun√ß√£o ass√≠ncrona trata e processa os dados recebidos na resposta, e na sequ√™ncia, retorna um Objeto contendo v√°rias propriedades √∫teis.

No React, as Requisi√ß√µes HTTP, geralmente s√£o utilizadas em conjunto com os Hooks **useState** e **useEffect**, para armazenar e exibir os dados recebidos pelas Respostas HTTP. Por exemplo, √© poss√≠vel fazer uma Requisi√ß√£o HTTP para uma API no momento em que um Componente √© montado (1¬∫ etapa  do Ciclo de Vida do Componente), usando o Hook **useEffect** e, em seguida, armazenar os dados recebidos em uma Estado da aplica√ß√£o React, atrav√©s do Hook **useState** e posteriormente serem exibidos na tela.

No Projeto Blog Pessoal, utilizaremos a Biblioteca **Axios**, como veremos a seguir:

<br />

<h2>1. A Biblioteca Axios</h2>



O **Axios** √© uma Biblioteca JavaScript de Comunica√ß√£o HTTP, baseada em **Promises** (Promessas), que permite que as pessoas desenvolvedoras fa√ßam Requisi√ß√µes HTTP para a sua pr√≥pria API (Backend da aplica√ß√£o) e para API's de terceiros. 

<div align="center"><img src="https://i.imgur.com/d8r03iQ.png" title="source: imgur.com" width="80%"/></div>

**A grande vantagem do Axios √© que ele √© f√°cil de usar e fornece uma s√©rie de recursos √∫teis para lidar com requisi√ß√µes HTTP.**

Principais recursos do Axios:

- **Suporte a Promises:** o Axios retorna uma Promise, o que facilita o tratamento da resposta da requisi√ß√£o;
- **Intercep√ß√£o de Requisi√ß√µes e Respostas:** permite que as requisi√ß√µes e respostas sejam interceptadas para serem modificadas ou tratadas de forma espec√≠fica antes de serem enviadas ou exibidas na aplica√ß√£o;
- **Suporte ao cancelamento de Requisi√ß√µes:** permite que as requisi√ß√µes sejam canceladas, caso necess√°rio, o que pode melhorar a performance da aplica√ß√£o;
- **Suporte a configura√ß√µes globais:** permite que configura√ß√µes globais sejam definidas para todas as requisi√ß√µes feitas pela aplica√ß√£o, como headers, por exemplo.

<br />

<h3>1.1. Como o Axios funciona?</h3>



Quando voc√™ faz uma Requisi√ß√£o HTTP utilizando o Axios, voc√™ configura a Requisi√ß√£o informando a URL (endere√ßo do endpoint, que ser√° consumido), o m√©todo HTTP (GET, POST, PUT ou DELETE), os Cabe√ßalhos da Requisi√ß√£o (adicionando o Token JWT, por exemplo), e os dados que ser√£o enviados no Corpo da Requisi√ß√£o, caso necess√°rio.

O Axios cria um objeto de configura√ß√£o que cont√©m todas essas informa√ß√µes e envia as Requisi√ß√µes HTTP de 2 formas:

- Atrav√©s do **NodeJS**, utilizando a Biblioteca **HTTP**, que √© parte integrante do Node;
- Atrav√©s dos **Navegadores WEB**, utilizando a API **XMLHttpRequests**. 

> **XMLHttpRequest** √© uma API dispon√≠vel em linguagens de script para navegadores web, como o JavaScript, que permite enviar Requisi√ß√µes HTTP ou HTTPS diretamente para um servidor web e carregar os dados obtidos na Resposta do servidor no script. 

Se a Requisi√ß√£o HTTP foi bem sucedida, o Axios resolver√° a Promise e voc√™ receber√° uma Resposta HTTP contendo um HTTP Status Code da categoria 200, al√©m dos dados solicitados. 

Se a Requisi√ß√£o HTTP falhar, o Axios rejeitar√° a Promise e voc√™ receber√° uma Resposta HTTP contendo um HTTP Status Code da categoria 400 (erro nos dados enviados) ou 500 (falha de processamento).

O objeto Resposta, gerado pelo Axios, cont√©m as seguintes propriedades:

- **data:** Os dados da resposta (geralmente no formato JSON).
- **status:** O c√≥digo de status HTTP.
- **statusText:** O texto do status associado ao c√≥digo de status HTTP (por exemplo, "OK" para status 200).
- **headers:** Os cabe√ßalhos da resposta HTTP.
- **config:** A configura√ß√£o da requisi√ß√£o original.
- **request:** O objeto de requisi√ß√£o original (√∫til para depura√ß√£o

O Axios tamb√©m possui uma etapa fundamental, que √© executada tanto na Requisi√ß√£o, quanto na Resposta, que √© a Transforma√ß√£o de dados, onde o Axios converte automaticamente respostas JSON em objetos JavaScript e vice-versa, evitando que voc√™ tenha que fazer isso manualmente.

O diagrama abaixo mostra uma representa√ß√£o gr√°fica de como o Axios interage com uma API:

<div align="center"><img src="https://i.imgur.com/OyFjwqJ.png" title="source: imgur.com" /></div>

Na pr√°tica: 

- O Axios cria o Objeto que representa a Requisi√ß√£o HTTP, transforma os dados que ser√£o enviados no Corpo da Resposta (Objeto JavaScript/TypeScript para JSON), envia a Requisi√ß√£o para a API e aguarda a Resposta. 

- Ao receber a Resposta, o Axios transforma os dados recebidos no Corpo da Resposta (JSON para Objeto JavaScript/TypeScript), cria o Objeto de Resposta e retorna esta Resposta para a aplica√ß√£o React. 

Como o Axios utiliza Promises, a aplica√ß√£o continua funcionando normalmente durante este processo, enquanto a Requisi√ß√£o HTTP √© processada em segundo plano.

O **Axios** √© capaz de determinar se a Requisi√ß√£o foi realizada pelo Navegador ou pelo NodeJS. Uma vez que isso √© estabelecido, ele identifica a maneira  correta de fazer as Requisi√ß√µes HTTP para o Backend e a forma correta de retornar a Resposta HTTP para o cliente que fez a Requisi√ß√£o HTTP.

<br />

<h3>1.2. M√©todos do Axios</h3>



O Axios oferece suporte a todos os M√©todos HTTP. Em nossa aplica√ß√£o utilizaremos os 4 M√©todos principais, representados pelas fun√ß√µes abaixo:

- `axios.get(url, options)`
- `axios.post(url, data, options)`
- `axios.put(url, data, options)`
- `axios.delete(url, options)`

**Onde:**

- **url:** √â o endere√ßo do endpoint;
- **data:** Os dados que ser√£o persistidos ou atualizados;
- **options:** As configura√ß√µes opcionais, como o Tokens no cabe√ßalho da Requisi√ß√£o, por exemplo.

<br />

<h2>2. Exemplo Pr√°tico - Axios</h2>



Para exemplificar o funcionamento do Axios, vamos criar um exemplo de uma Requisi√ß√£o do tipo GET, dentro do **Projeto React Playground**:

<br />

> [!CAUTION]
>
> Antes de iniciarmos, crie uma nova Branch no **Projeto React Playground**, chamada **axios**, para n√£o perder o conte√∫do dos exemplos criados anteriormente.

<br />

<h2>üë£Passo 01 - Instalar o Axios</h2>



1. Abra o Projeto **React Playground** no Visual Studio Code
2. Abra o Terminal do Visual Studio Code
3. Instale o **Axios** no Projeto **React Playground**, atrav√©s do comando abaixo:

```bash
yarn add axios
```

<br />

<div align="left"><img src="https://i.imgur.com/A94hGdN.png" title="source: imgur.com" width="4%"/> <a href="https://www.npmjs.com/package/axios" target="_blank"><b>Axios - Documenta√ß√£o de Instala√ß√£o e Tutorial</b></a></div>

<br />

<h2>üë£Passo 02 - Criar a Service</h2>



1. Na pasta **src**, crie a pasta **services**
2. Na pasta **services**, crie o arquivo **Service.ts**
3. Adicione o c√≥digo abaixo no arquivo **Service.ts**:

```typescript
import axios from "axios";

const api = axios.create({
    baseURL: 'https://jsonplaceholder.typicode.com'
})

export const consultar = async (url: string, setDados: Function) => {
    const resposta = await api.get(url)
    setDados(resposta.data)
}
```

**Vamos analisar o c√≥digo:**

<div align="center"><img src="https://i.imgur.com/f57k6rg.png" title="source: imgur.com" /></div>

**Linha 01:** Importamos a Biblioteca Axios. 

**Linhas 03 a 05:** Criamos uma inst√¢ncia da Biblioteca **Axios**, chamada **api**, atrav√©s do **m√©todo create()**. Dentro do m√©todo, definimos um objeto de configura√ß√£o, que possui a propriedade **baseURL**. Na propriedade **baseURL**, inserimos o **Link da API**, que iremos consumir.

<br />

> [!NOTE]
>
> A API **JSON Placeholder** (https://jsonplaceholder.typicode.com/) √© uma API para testes, gratuita, que utilizaremos neste exemplo para explicar o funcionamento b√°sico da Biblioteca AXIOS.

<br />

**Linhas 07 a 10:** Constru√≠mos e exportamos a fun√ß√£o ass√≠ncrona chamada **consultar**, que enviar√° uma Requisi√ß√£o HTTP do tipo GET para API.

**Linha 07:** Criamos uma **Arrow Function**, que receber√° tr√™s argumentos:

- **url:** √â uma string que representa o endere√ßo do endpoint da API, que receber√° a Requisi√ß√£o HTTP GET. Essa URL ser√° anexada √† URL base definida anteriormente definida na inst√¢ncia do Axios (**baseURL - Linha 04**).
- **setDados:** √â a fun√ß√£o que ser√° utilizada para atualizar o Estado, que receber√° os dados enviados pelo Backend no corpo da resposta da Requisi√ß√£o HTTP. Este Estado, pode ser um √∫nico objeto ou um array, que armazenar√° v√°rios objetos.

**Linha 08:** Cria a Requisi√ß√£o HTTP GET, utilizando a URL especificada no par√¢metro de mesmo nome, atrav√©s da inst√¢ncia do **Axios**, que foi criada anteriormente e a fun√ß√£o que ser√° utilizada para atualizar o Estado com os dados da busca. Como o M√©todo HTTP GET n√£o persiste dados no Backend, n√£o enviaremos dados no Corpo da Requisi√ß√£o.

**Linha 09:** Ap√≥s a conclus√£o da Requisi√ß√£o HTTP, o Corpo da Resposta da Requisi√ß√£o ser√° armazenado no Estado **usuarios** (criado no Componente ListaUsuarios), atrav√©s da fun√ß√£o **setDados**, que receber√° a fun√ß√£o **setUsuarios** (criada no Componente ListaUsuarios). Desta forma atualizaremos os dados do Estado **usuarios** com os dados retornados pelo Backend ap√≥s uma busca bem-sucedida.

<br />

> [!TIP]
>
> Da mesma forma que criamos a fun√ß√£o **consultar**, que envia uma Requisi√ß√£o HTTP do tipo **GET**, tamb√©m podemos criar fun√ß√µes para enviar Requisi√ß√µes do tipo **POST, PUT e DELETE**, lembrando apenas que nos casos das Requisi√ß√µes do tipo POST e PUT precisamos enviar dados no Corpo da Requisi√ß√£o.

<br />

<h2>üë£Passo 03 - Criar o Componente ListarUsuarios</h2>



1. Na pasta **src**, crie a pasta **components**
2. Na pasta **components**, crie a pasta **usuarios**
3. Na pasta **usuarios**, crie a pasta **listarusuarios**
4. Na pasta **listarusuarios**, crie o arquivo **ListarUsuarios.tsx**
5. Adicione o c√≥digo abaixo no Componente **ListarUsuarios**:

```tsx
import { useEffect, useState } from 'react';
import { consultar } from '../../../services/Service';

interface Usuario {
  id: number;
  name: string;
}

function ListarUsuarios() {

  const [usuarios, setUsuarios] = useState<Usuario[]>([]);

  async function consultarUsuarios() {

    try {
      await consultar('/users', setUsuarios);
    } catch (error: any) {
      alert('Erro!')
    }
    
  }

  useEffect(() => {
    consultarUsuarios();
  }, []);

  return (
    <div className='lista'>
      <h1>Lista de usu√°rios - Gerada pelo Axios</h1>
      <ul>
        {usuarios.map( (usuario) => (
          <li key={usuario.id}>{usuario.name}</li>
        ))}
      </ul>
    </div>
  );
}

export default ListarUsuarios;
```

**Vamos analisar o c√≥digo:**

<div align="center"><img src="https://i.imgur.com/ZtKQorm.png" title="source: imgur.com" /></div>

**Linha 01:** Importamos a Biblioteca Axios. 

**Linhas 04 a 07:** Criamos uma Interface, chamada **Usuario**, contendo o modelo de dados que ser√° retornado na Resposta da Requisi√ß√£o. Esta Interface funcionar√° de modo semelhante a Classe Model do Backend, mas ser√° utilizada apenas como um "molde" para receber os dados do Backend.

**Linha 11:** Criamos um novo estado, atrav√©s do Hook **useState**, contendo um array vazio, do tipo da Interface **Usuario**, que receber√° todos os Objetos da Classe User do Backend.

**Linhas 13 a 21:** Criamos a fun√ß√£o ass√≠ncrona **consultarUsuarios()**, que √© respons√°vel por realizar o processo de busca dos usu√°rios persistidos no Backend, atualizando o Estado **usuarios** com os resultados encontrados. 

**Linhas 15 a 17:** Dentro do bloco **try**, invocamos a fun√ß√£o **consultar** da **Service**. Seguindo sua estrutura, inserimos a URL do endpoint Listar todos os usu√°rios e a fun√ß√£o **setUsuarios**, que ir√° atualizar o estado usuarios. ap√≥s a conclus√£o do processo. 

A palavra-chave **await** indica que a fun√ß√£o **consultar** √© ass√≠ncrona e ficar√° aguardando a conclus√£o da Requisi√ß√£o HTTP antes de continuar o fluxo da Fun√ß√£o **consultarUsuarios()**.

**Linhas 17 a 19:** Caso ocorra algum erro no processo dentro do bloco **try**, a estrutura **catch** captura o erro e exibe um alerta informando que ocorreu algum erro no processo.

**Linhas 23 a 25:** Atrav√©s do Hook **useEffect**, vamos executar a fun√ß√£o **consultarUsuarios()** ser√° executado apenas uma vez, na primeira Renderiza√ß√£o do Componente **ListarUsuarios**.

**Linhas 31 a 33:** A fun√ß√£o **map()** √© uma fun√ß√£o JavaScript utilizada para processar Arrays. Ela √© usada para criar um novo array, ap√≥s iterar cada elemento do array de origem (Estado usuarios) e aplicar uma transforma√ß√£o, atrav√©s de uma Arrow Function, passada como par√¢metro da fun√ß√£o map. 

No exemplo acima, criamos uma Arrow Function, que ser√° respons√°vel por exibir os dados dos usu√°rios armazenados no estado **usuarios**, um a um, em uma lista n√£o ordenada `<ul>`. Observe que os dados ser√£o acessados atrav√©s das propriedades definidas na Interface **Usuario**.

<br />

<h2>üë£ Passo 04 - Atualizar o Componente App</h2>



Vamos atualizar o Componente **App**, inserindo o Componente **ListarUsuarios**:

1. Na pasta **src**, abra o Componente **App**.
2. Substitua o c√≥digo do Componente **App**, pelo trecho de c√≥digo abaixo:

```tsx
import './App.css'
import ListarUsuarios from './components/usuarios/listarusuarios/ListarUsuarios'

function App() {

  return (
    <>
      <ListarUsuarios />
    </>
  )
}

export default App

```

<br />

<h2>üë£ Passo 05 - Testar o Componente</h2>



Chegou o momento de vermos os nossos Componentes no Navegador!

1. Para executar o Projeto no Navegador, digite o comando abaixo no Terminal do Visual Studio Code:

```bash
yarn dev
```

2. Pressione a combina√ß√£o de teclas **o + enter** do seu teclado para abrir o Projeto no Navegador
3. O seu Projeto React ser√° aberto no Navegador, exibindo o Componente Home:

<div align="center"><img src="https://i.imgur.com/J9fpPKn.png" title="source: imgur.com" /></div>

Observe que o Componente **ListarUsuarios** exibir√° na tela a lista com todos os usu√°rios cadastrados no Backend.

<br />

<div align="left"><img src="https://i.imgur.com/A94hGdN.png" title="source: imgur.com" width="4%"/> <a href="https://axios-http.com/" target="_blank"><b>Axios - Documenta√ß√£o Oficial</b></a></div>

<br /><br />

<div align="left"><a href="README.md"><img src="https://i.imgur.com/XMgF3gl.png" title="source: imgur.com" width="3%"/>Voltar</a></div>
