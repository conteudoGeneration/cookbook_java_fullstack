<h1>Deploy do Backend no Render</h1>

<br />

## 1. O que √© Deploy?

<br />

> O verbo **deploy**, em ingl√™s, significa **implantar**.

No contexto da programa√ß√£o, o termo est√° diretamente associado √† sua tradu√ß√£o literal: **fazer um deploy** significa disponibilizar uma aplica√ß√£o na Internet, ou seja, **public√°-la na nuvem** ap√≥s a finaliza√ß√£o do seu desenvolvimento.

Quando um site ou sistema √© conclu√≠do por uma pessoa desenvolvedora, ele passa por testes finais e, em seguida, √© **hospedado na nuvem por meio do processo de deploy**. Esse processo torna a aplica√ß√£o acess√≠vel ao p√∫blico ou aos usu√°rios finais.

Al√©m disso, quando uma aplica√ß√£o j√° publicada (em **produ√ß√£o**) recebe melhorias ou altera√ß√µes em seu c√≥digo, a **atualiza√ß√£o do sistema em produ√ß√£o tamb√©m √© considerada um deploy** ‚Äî nesse caso, chamado de **deploy incremental**, pois consiste na entrega de uma nova vers√£o da aplica√ß√£o sem a necessidade de reconstru√≠-la por completo.

<br />

## 2. O que veremos por aqui?



Esse documento √© um passo a passo para voc√™ enviar a sua aplica√ß√£o Spring, gratuitamente para a nuvem. Este processo ir√° gerar um link de acesso a sua aplica√ß√£o, que poder√° ser acessado de qualquer lugar, a partir de qualquer dispositivo com acesso a Internet. 
Para efetuar o Deploy vamos precisar fazer algumas modifica√ß√µes em nosso projeto, que ser√£o detalhadas nos pr√≥ximos t√≥picos.

<br />

## üë£ Passo 01 - Criar a Documenta√ß√£o da API



Para criar a Documenta√ß√£o da API no Swagger, utilize o <a href="24.md" target="_blank">**Guia de Configura√ß√£o do Springdoc**</a>.

<br />

## üë£ Passo 02 - Testar a API no seu computador



1. **Execute a sua aplica√ß√£o localmente** utilizando o **STS**.

2. Acesse o endere√ßo: **http://localhost:8080/** no seu navegador.

3. A aplica√ß√£o dever√° exibir a tela de **Login (Usu√°rio e Senha)**. Utilize as credenciais criadas anteriormente:
   - **Usu√°rio:** `root@root.com`
   - **Senha:** `rootroot`


<div align="center"><img src="https://i.imgur.com/mBRxYd8.png" title="source: imgur.com" width="50%"/></div>

4. Caso a aplica√ß√£o **n√£o solicite o login**, feche todas as janelas do seu navegador, abra novamente e acesse o endere√ßo novamente.

   - Se o problema persistir, **verifique a configura√ß√£o do Swagger**.
5. Ap√≥s o login, **verifique se o Swagger est√° sendo carregado automaticamente**.
6. Caso ainda n√£o tenha testado no **Insomnia**, realize os testes agora e verifique se a aplica√ß√£o est√° respondendo corretamente.
7. Em especial, **confirme se o m√©todo `logar` est√° retornando o Token** de autentica√ß√£o com sucesso.
8. **Antes de prosseguir com a configura√ß√£o para o Deploy**, **lembre-se de parar a execu√ß√£o da aplica√ß√£o no STS**.

<br />

| <img src="https://i.imgur.com/hOgWvSc.png" title="source: imgur.com" width="100px"/> | <p align="justify"> **IMPORTANTE:**  **N√£o altere a senha do usu√°rio `root@root.com`**. Os instrutores da sua turma utilizar√£o este usu√°rio para abrir, testar e corrigir a sua aplica√ß√£o. </p> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

| <img src="https://i.imgur.com/hOgWvSc.png" title="source: imgur.com" width="100px"/> | <p align="justify"> **ATEN√á√ÉO:**  Antes de realizar o **Deploy**, √© fundamental que a aplica√ß√£o esteja **100% funcional e sem erros**. Realize todos os testes atrav√©s o **Insomnia** para garantir que todos os endpoints est√£o funcionando corretamente.</p> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

## üë£ Passo 03 - Criar uma conta gr√°tis no Render

<br />

<h3>3.1 O que √© o Render?</h3>



O **Render** √© uma plataforma unificada para **cria√ß√£o, hospedagem e execu√ß√£o de aplicativos e sites** na nuvem. Ele oferece recursos como **SSL gratuito**, **CDN global**, **rede privada** e **implanta√ß√µes autom√°ticas via Git**, simplificando o ciclo de desenvolvimento e publica√ß√£o.

> Uma **CDN** (Content Delivery Network ‚Äì Rede de Entrega de Conte√∫do) √© um conjunto de servidores distribu√≠dos geograficamente que acelera a entrega de conte√∫do na web, aproximando os dados dos usu√°rios finais.

O Render √© classificado como uma plataforma do tipo **PaaS (Platform as a Service)**, ou seja, fornece um conjunto de servi√ßos prontos para que desenvolvedores possam criar, integrar, migrar, implantar, proteger e gerenciar aplica√ß√µes web e m√≥veis de maneira pr√°tica e eficiente.

<br />

<h3>3.2. Modelos de Servi√ßos em Nuvem</h3>



- **PaaS (Plataforma como Servi√ßo):** O provedor oferece um ambiente completo baseado em nuvem para o desenvolvimento e execu√ß√£o de aplica√ß√µes. Exemplos: **Render**, **Heroku**, **Microsoft Azure**.
- **IaaS (Infraestrutura como Servi√ßo):** Fornece recursos de infraestrutura (como servidores, rede e armazenamento) sob demanda. Exemplos: **Amazon Web Services (AWS)**, **DigitalOcean**.
- **SaaS (Software como Servi√ßo):** O provedor disponibiliza softwares e servi√ßos prontos via internet, geralmente sob forma de assinatura. Exemplos: **Google Workspace**, **Microsoft 365**.

<br />

<h3> 3.3. Diferenciais do Render</h3>



Um dos principais atrativos do Render √© a oferta de um **plano gratuito**, que permite:

- Hospedar aplica√ß√µes em diversas linguagens de programa√ß√£o;
- Criar **uma inst√¢ncia gratuita de banco de dados PostgreSQL**.

<br />

<h3> 3.4. Limita√ß√µes do Plano Gratuito do Render</h3>



- A aplica√ß√£o √© finalizada automaticamente se ficar **15 minutos sem receber requisi√ß√µes**. Ela ser√° reiniciada apenas na pr√≥xima solicita√ß√£o.
- Os servidores est√£o localizados **apenas na Europa, √Åsia e nos Estados Unidos**.
- Os recursos de **mem√≥ria, CPU e armazenamento** s√£o limitados, tornando-o mais adequado para projetos pequenos ou de testes.
- **Apenas um banco de dados PostgreSQL gratuito por conta** √© permitido.
- O banco de dados gratuito **expira ap√≥s 30 dias**. Um e-mail √© enviado pr√≥ximo da data de expira√ß√£o.
- O uso total √© limitado a **750 horas mensais** (aplica√ß√µes + banco de dados). Ao ultrapassar esse limite, os servi√ßos s√£o suspensos at√© o pr√≥ximo ciclo.
- Dependendo da linguagem utilizada, **o deploy pode exigir o uso de Docker**.

<br />

<div align="left"><img src="https://i.imgur.com/RjyAYeB.png" title="source: imgur.com" width="4%"/> <a href="https://render.com/docs/free" target="_blank"><b>Documenta√ß√£o: Render - Plano Gratuito</b></a></div>

<br />

<h3> 3.5. Limita√ß√µes do Plano Gratuito do Render</h3>



Vamos criar uma conta gratuita no **Render** para fazermos o Deploy:

1) Acesse o endere√ßo: **https://render.com**
1) Na p√°gina inicial do Render, clique no bot√£o **Get Started**, localizado no canto direito superior da tela

<div align="center"><img src="https://i.imgur.com/FSXqGdA.png" title="source: imgur.com"/></div>

3. Ser√° aberta a janela **Create an account**. Observe na imagem abaixo que existem diversas maneiras de criar uma nova conta no Render.

<div align="center"><img src="https://i.imgur.com/aaoTXu2.png" title="source: imgur.com" /></div>

4. Vamos criar uma nova conta no Render utilizando o Github. Clique no bot√£o **GitHub**, como mostra a imagem abaixo:

<div align="center"><img src="https://i.imgur.com/jBDiOq4.png" title="source: imgur.com" /></div>

5. Na pr√≥xima janela, caso voc√™ n√£o esteja autenticado (logado) na sua conta do Github, ser√° solicitado que voc√™ digite o seu usu√°rio ou o endere√ßo do e-mail cadastrado, al√©m da senha da sua conta do Github, e em seguida clique no bot√£o **Sign in**

<div align="center"><img src="https://i.imgur.com/McXaD9t.png" title="source: imgur.com" /></div>

6. Na pr√≥xima janela, autorize o Render a acessar a sua conta do Github, clicando no bot√£o **Authorize Render**.

<div align="center"><img src="https://i.imgur.com/i9PbiwS.png" title="source: imgur.com" /></div>

7. Voc√™ ser√° redirecionado para a tela do **Render Dashboard**, como mostra a imagem abaixo:

<div align="center"><img src="https://i.imgur.com/4DPfwdN.png" title="source: imgur.com" /></div>

<br />

## üë£ Passo 04 - Adicionar a Depend√™ncia do PostgreSQL no pom.xml



A plataforma **Render**, em seu plano gratuito, oferece suporte ao Banco de dados Relacional **PostgreSQL** como sistema gerenciador de banco de dados (SGBD).

No **Bloco 02**, estamos utilizando o **MySQL** para desenvolver o projeto do **Blog Pessoal**. Ambos s√£o bancos de dados relacionais, e, gra√ßas √† abstra√ß√£o fornecida pelo **Spring Data JPA**, **n√£o ser√° necess√°rio alterar o c√≥digo da aplica√ß√£o** para trocar o banco de dados.

A √∫nica modifica√ß√£o necess√°ria ser√°:

- **Adicionar a depend√™ncia do PostgreSQL no arquivo `pom.xml`**;
- **Configurar a conex√£o com o Banco de dados PostgreSQL hospedado na nuvem**.

Essa compatibilidade √© poss√≠vel porque o Spring Data JPA utiliza uma camada de abstra√ß√£o que permite trabalhar com diferentes bancos de dados relacionais com m√≠nimas altera√ß√µes na estrutura da aplica√ß√£o, desde que as entidades e consultas estejam adequadas ao padr√£o JPA.

<br />

<div align="left"><img src="https://i.imgur.com/b3khcJI.png" title="source: imgur.com" width="25px"/> <a href="https://www.postgresql.org/" target="_blank"><b>Site Oficial: PostgreSQL</b></a></div>

<br />
	
No arquivo, **pom.xml**, vamos adicionar as linhas abaixo, com a depend√™ncia do **PostgreSQL**:

```xml
<!-- Depend√™ncia do Banco de dados PostgreSQL -->
<dependency>
	<groupId>org.postgresql</groupId>
	<artifactId>postgresql</artifactId>
</dependency> 
```

<br />

## üë£ Passo 05 - Configurar o Banco de Dados na Nuvem



A configura√ß√£o do banco de dados **local** √© diferente daquela que ser√° utilizada na **plataforma Render**.

No passo anterior, adicionamos a depend√™ncia do **PostgreSQL** no arquivo `pom.xml`. Agora, vamos configurar a aplica√ß√£o para acessar o banco de dados **remoto**, que ser√° provisionado no **Render**.

Para facilitar esse processo, utilizaremos um recurso do Spring chamado **Profiles** (ou *perfis*), que permite definir diferentes arquivos de configura√ß√£o para cada ambiente da aplica√ß√£o. Assim, teremos:

- Um arquivo para o ambiente **local**, com o MySQL (`application-dev.properties`);
- E outro para o ambiente **de produ√ß√£o**, com o PostgreSQL na nuvem (`application-prod.properties`).

A principal vantagem dos **Spring Profiles** √© justamente permitir alternar entre diferentes configura√ß√µes ‚Äî por exemplo, entre banco de dados local e remoto ‚Äî de forma simples, sem a necessidade de alterar o c√≥digo-fonte da aplica√ß√£o.

1) Na Source Folder **src/main/resources**, crie os arquivos **application-dev.properties** (Configura√ß√£o do Banco de dados local) e **application-prod.properties** (Configura√ß√£o do Banco de dados na nuvem), como mostra a imagem abaixo:

<div align="center"><img src="https://i.imgur.com/EKZASZm.png" title="source: imgur.com" /></div>

<br />

| <img src="https://i.imgur.com/vVDBDG0.png" title="source: imgur.com" width="250px"/> | <p align="justify"> **ALERTA DE BSM:** Mantenha a aten√ß√£o aos detalhes ao criar os arquivos application-dev.properties e application-prod.properties. Cuidado para n√£o se equivocar ao nomear os arquivos ou criar os arquivos em outra Source Folder.</p> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

2. Vamos criar o primeiro arquivo. No lado esquerdo superior, na **Guia Package explorer**, na Source Folder **src/main/resources**, clique com o bot√£o direito do mouse e clique na op√ß√£o **New ü°¢ File**.

3) Em **File name**, digite o nome do primeiro arquivo (**application-dev.properties**) e clique no bot√£o **Finish**.

<div align="center"><img src="https://i.imgur.com/Q1s30nm.png" title="source: imgur.com" /></div>

4. Vamos criar o segundo arquivo da mesma forma que criamos o primeiro.

5. Em **File name**, digite o nome do segundo arquivo (**application-prod.properties**) e clique no bot√£o **Finish**.

<div align="center"><img src="https://i.imgur.com/pSiak7m.png" title="source: imgur.com" /></div>

Agora vamos configurar os 3 arquivos **.properties**:

<br />

<h3>5.1 Configura√ß√£o do arquivo application.properties</h3>



1. Abra o arquivo **application.properties**, **apague todo o conte√∫do do arquivo** e substitua pelas linhas abaixo  e salve o arquivo.

```properties
spring.profiles.active=prod

springdoc.api-docs.path=/v3/api-docs
springdoc.swagger-ui.path=/swagger-ui.html
springdoc.swagger-ui.operationsSorter=method
springdoc.swagger-ui.disable-swagger-default-url=true
springdoc.swagger-ui.use-root-path=true
springdoc.packagesToScan=com.generation.blogpessoal.controller
```

<br />

| <img src="https://i.imgur.com/vVDBDG0.png" title="source: imgur.com" width="250px"/> | <p align="justify"> **ALERTA DE BSM:** Mantenha a aten√ß√£o aos detalhes ao configurar o arquivo application.properties. Verifique se o valor atribu√≠do √† propriedade **`springdoc.packagesToScan`** corresponde exatamente aos **pacotes da sua aplica√ß√£o** onde est√£o localizadas as classes `@RestController`. Caso esteja diferente, **ajuste o nome do pacote** conforme a estrutura do seu projeto. </p> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

<h3>5.2 Configura√ß√£o do arquivo application-dev.properties</h3>



1. Abra o arquivo **application-dev.properties**, insira as linhas abaixo (a primeira configura√ß√£o do arquivo  **application.properties**) e salve o arquivo. 

```properties
spring.application.name=blogpessoal
spring.jpa.hibernate.ddl-auto=update
spring.jpa.database=mysql
spring.datasource.url=jdbc:mysql://localhost/db_blogpessoal?createDatabaseIfNotExist=true&serverTimezone=America/Sao_Paulo&useSSl=false
spring.datasource.username=root
spring.datasource.password=root
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver

spring.jpa.show-sql=true
spring.jpa.properties.hibernate.dialect = org.hibernate.dialect.MySQLDialect

spring.jpa.properties.jakarta.persistence.sharedCache.mode=ENABLE_SELECTIVE

spring.jackson.date-format=yyyy-MM-dd HH:mm:ss
spring.jackson.time-zone=America/Sao_Paulo
spring.jackson.serialization.write-dates-as-timestamps=false
spring.jackson.serialization.fail-on-empty-beans=false
spring.jackson.serialization.fail-on-self-references=false
```

<br />

| <img src="https://i.imgur.com/vVDBDG0.png" title="source: imgur.com" width="180px"/> | <p align="justify"> **ALERTA DE BSM:** Mantenha a aten√ß√£o aos detalhes ao configurar o arquivo application-dev.properties. N√£o esque√ßa de alterar a senha do usu√°rio root caso a sua senha do MySQL n√£o seja root. </p> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

<h3>5.3 Configura√ß√£o do arquivo application-prod.properties</h3>



1. No arquivo, **application-prod.properties**,  insira as linhas abaixo e salve o arquivo:

```properties
spring.application.name=blogpessoal
spring.datasource.url=jdbc:postgresql://${POSTGRESHOST}:${POSTGRESPORT}/${POSTGRESDATABASE}
spring.datasource.username=${POSTGRESUSER}
spring.datasource.password=${POSTGRESPASSWORD}
spring.datasource.driver-class-name=org.postgresql.Driver

spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true
spring.jpa.open-in-view=true

spring.jpa.properties.jakarta.persistence.sharedCache.mode=ENABLE_SELECTIVE

spring.jackson.date-format=yyyy-MM-dd HH:mm:ss
spring.jackson.time-zone=America/Sao_Paulo
spring.jackson.serialization.write-dates-as-timestamps=false
spring.jackson.serialization.fail-on-empty-beans=false
spring.jackson.serialization.fail-on-self-references=false
```

Observe que, nas configura√ß√µes referentes ao acesso ao banco de dados na nuvem (como endere√ßo, nome de usu√°rio, senha, entre outros), utilizamos **vari√°veis de ambiente**. Essas vari√°veis ser√£o definidas diretamente na plataforma **Render**, contendo os dados de acesso ao banco PostgreSQL provisionado.

O uso de vari√°veis de ambiente √© uma pr√°tica recomendada para manter as credenciais e configura√ß√µes sens√≠veis fora do c√≥digo-fonte. No Render, elas podem ser definidas no painel do servi√ßo e ser√£o automaticamente disponibilizadas para a aplica√ß√£o em tempo de execu√ß√£o.

<br />

| <img src="https://i.imgur.com/hOgWvSc.png" title="source: imgur.com" width="100px"/> | <div align="left"> **ATEN√á√ÉO:** *Depois de finalizar as configura√ß√µes dos 3 arquivos, recomendamos executar o comando Update Project do STS para atualizar as configura√ß√µes do projeto.* </div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

<h3>5.4 Alternando entre os perfis no arquivo application.properties</h3>



Para alternar entre as configura√ß√µes Local e Remota, abra o arquivo **application.properties** e utilize uma das 2 op√ß√µes abaixo:

- `spring.profiles.active=dev` ü°¢ O Spring executar√° a aplica√ß√£o com a configura√ß√£o do Banco de dados local (MySQL)
- `spring.profiles.active=prod` ü°¢ O Spring executar√° a aplica√ß√£o com a configura√ß√£o do Banco de dados na nuvem (Render)

Para o Deploy, devemos deixar a linha `spring.profiles.active` configurada com a op√ß√£o **prod**.

<br />

| <img src="https://i.imgur.com/vVDBDG0.png" title="source: imgur.com" width="250px"/> | <p align="justify"> **ALERTA DE BSM:** *Mantenha a aten√ß√£o aos detalhes ao criar os perfis do Banco de Dados. Um erro muito comum √© tentar executar o seu projeto no STS com o Perfil prod habilitado no arquivo application.properties. Com o perfil prod habilitado, a aplica√ß√£o n√£o ser√° executada corretamente.* </p> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

## üë£ Passo 06 - Criar o arquivo Dockerfile



O Render n√£o possui nativamente o suporte ao Java. Como op√ß√£o para fazer o Deploy de aplica√ß√µes Java, o Render oferece a possibilidade de utilizar o **Docker**, como alternativa para efetuar o deploy de aplica√ß√µes que ele n√£o oferece suporte nativo.

O **Docker** √© um projeto para automatizar a implanta√ß√£o de aplicativos como **Containers** autossuficientes e port√°teis, que podem ser executados na nuvem ou localmente, a partir de **imagens** contendo o ambiente m√≠nimo para executar uma aplica√ß√£o. 

Uma **Imagem** nada mais √© do que uma **representa√ß√£o imut√°vel** de como ser√° efetivamente constru√≠do um container. **Exemplo:** uma imagem contendo o Ubuntu Linux, uma imagem contendo o compilador Java, entre outros. 

Como uma imagem √© imut√°vel, n√≥s n√£o podemos executar a imagem de forma direta, n√≥s fazemos isso atrav√©s de um **Container**, que √© uma tecnologia que permite empacotar e isolar aplica√ß√µes com  o seu  ambiente de tempo de execu√ß√£o, ou seja, com todos os arquivos  necess√°rios para executar. Na imagem abaixo vemos uma representa√ß√£o gr√°fica do ambiente Docker:

<div align="center"><img src="https://i.imgur.com/6INLTtc.png" title="source: imgur.com" /></div>

> Na imagem acima vemos os principais elementos do ambiente Docker:
>
> 1) **Infraestrutura (Servidor - Hardware):** √â a base de tudo ‚Äî seu computador ou servidor com CPU, mem√≥ria, armazenamento e rede.
> 2) **Sistema Operacional Host:** O sistema operacional que est√° instalado no hardware, como Linux, Windows ou macOS. Ele gerencia os recursos do hardware.
> 3) **Docker Engine (Container Engine):** Esse √© o programa que roda no sistema operacional host. Ele √© o respons√°vel por criar e controlar os **containers**.
> 4) **Containers:** Como mostra a imagem, o Docker cria v√°rios containers ‚Äî pequenas ‚Äúcaixas‚Äù isoladas que cont√©m as aplica√ß√µes e as respectivas bibliotecas (no caso do Spring, as Depend√™ncias. Cada container compartilha o kernel do sistema operacional, mas mant√©m seu ambiente separado dos demais.
> 5) **Imagens Docker:** embora n√£o esteja explicitamente representado na imagem acima, as imagens Docker s√£o os ‚Äúmodelos‚Äù ou ‚Äúreceitas‚Äù usadas para criar os containers. A imagem inclui tudo o que a aplica√ß√£o precisa para rodar, como c√≥digo, bibliotecas e configura√ß√µes.

A imagem acima resume os principais componentes que formam o ambiente Docker. No nosso contexto ‚Äî deploy da aplica√ß√£o Spring no Render via Docker ‚Äî precisamos compreender que o processo √© dividido em tr√™s etapas, conforme ilustrado na imagem abaixo:

<div align="center"><img src="https://i.imgur.com/7jQda72.png" title="source: imgur.com" /></div>

1. **Dockerfile:** Voc√™ escreve um arquivo chamado **Dockerfile** que cont√©m as instru√ß√µes para montar a **imagem Docker** da sua aplica√ß√£o. Esse arquivo define qual sistema base ser√° usado, quais depend√™ncias instalar, qual comando executar para rodar a aplica√ß√£o, entre outras configura√ß√µes.
2. **Imagem Docker:**  A partir do Dockerfile, o Render **constr√≥i a imagem**. A imagem √© como um ‚Äúpacote pronto‚Äù contendo tudo que sua aplica√ß√£o precisa para rodar: c√≥digo, bibliotecas, configura√ß√µes, etc. Ela √© est√°tica, ou seja, n√£o est√° em execu√ß√£o.
3. **Container:** Quando a imagem est√° pronta, o Render cria um **container** a partir dela. O container √© a inst√¢ncia em execu√ß√£o da imagem ‚Äî √© onde sua aplica√ß√£o realmente roda, respondendo a requisi√ß√µes e executando tarefas.

No Projeto Blog Pessoal n√≥s iremos **construir o Dockerfile e o Render se encarregar√° de construir a Imagem e o Container com o ambiente necess√°rio para executar o projeto Blog Pessoal**.

<br />

| <img src="https://i.imgur.com/hOgWvSc.png" title="source: imgur.com" width="100px"/> | <div align="left"> **ATEN√á√ÉO:** *O nosso foco n√£o √© estudar o Docker. O foco neste momento √© compreender como criaremos o Dockerfile necess√°rio para efetuarmos o Deploy da nossa aplica√ß√£o no Render*.</div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

Veja na tabela abaixo os comandos do **Dockerfile** que vamos utilizar:

| Comando        | Descri√ß√£o Validada                                           |
| -------------- | ------------------------------------------------------------ |
| **FROM**       | Define a imagem base a partir da qual a nova imagem ser√° constru√≠da. Deve ser a primeira instru√ß√£o em um Dockerfile (exceto quando precedida por `ARG`). √â poss√≠vel utilizar imagens oficiais, como `openjdk` ou `ubuntu`, como ponto de partida para a constru√ß√£o da imagem personalizada. |
| **RUN**        | Executa comandos durante o processo de constru√ß√£o da imagem. Cada instru√ß√£o `RUN` cria uma nova camada na imagem. √â utilizada para instalar pacotes, compilar c√≥digo ou realizar outras tarefas necess√°rias para preparar o ambiente da aplica√ß√£o. |
| **COPY**       | Copia arquivos ou diret√≥rios do sistema de arquivos do host para o sistema de arquivos da imagem. √â usada para incluir o c√≥digo-fonte da aplica√ß√£o, arquivos de configura√ß√£o ou outros recursos necess√°rios dentro da imagem. |
| **VOLUME**     | Cria um ponto de montagem que permite que dados sejam persistidos fora do ciclo de vida do container. Define um diret√≥rio dentro do container que ser√° armazenado em um volume gerenciado pelo Docker, permitindo que os dados persistam mesmo ap√≥s o container ser removido. |
| **WORKDIR**    | Define o diret√≥rio de trabalho para as instru√ß√µes subsequentes no Dockerfile, como `RUN`, `CMD`, `ENTRYPOINT`, `COPY` e `ADD`. Se o diret√≥rio especificado n√£o existir, ele ser√° criado automaticamente. |
| **ENTRYPOINT** | Especifica o comando que ser√° executado quando um container for iniciado a partir da imagem. Diferente do `CMD`, o `ENTRYPOINT` n√£o pode ser sobrescrito ao passar argumentos na linha de comando durante a execu√ß√£o do container. Ele √© ideal para definir o comportamento principal do container. |
| **ARG**        | Define vari√°veis que podem ser passadas durante o processo de constru√ß√£o da imagem com o comando `docker build`. Essas vari√°veis est√£o dispon√≠veis apenas durante o tempo de constru√ß√£o e n√£o persistem na imagem final. |

O Render ao receber o Dockerfile atrav√©s do reposit√≥rio do Github, vai gerar a Imagem e o Container automaticamente, e caso n√£o aconte√ßa nenhum erro, a sua aplica√ß√£o ser√° implantada na nuvem e o Render lhe oferecer√° um endere√ßo (https://meuprojeto.onrender.com) para acessar externamente. Veja um resumo do processo na imagem abaixo:

<div align="center"><img src=https://i.imgur.com/bNzChTJ.png" title="source: imgur.com" /></div>

Vamos criar o arquivo **Dockerfile** no projeto Blog Pessoal:

1. Na **raiz do seu projeto**, na pasta **blogpessoal** (como mostra a figura abaixo), crie o arquivo **Dockerfile**.

<div align="center"><img src="https://i.imgur.com/iOdo9rb.png" title="source: imgur.com" /></div>

<br />

| <img src="https://i.imgur.com/vVDBDG0.png" title="source: imgur.com" width="250px"/> | <p align="justify"> **ALERTA DE BSM:** *Mantenha a aten√ß√£o aos detalhes ao criar o arquivo Dockerfile. Um erro muito comum √© n√£o criar o arquivo na pasta ra√≠z do projeto. Outro erro comum √© digitar o nome do arquivo com letras min√∫sculas. Observe que o arquivo inicia com letra mai√∫scula.*</p> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

2. Na Guia **Package Explorer**, clique com o bot√£o direito do mouse sobre a pasta do projeto (indicada em azul) e clique na op√ß√£o **New ü°¢ File**.

<div align="center"><img src="https://i.imgur.com/ykiTjTa.png" title="source: imgur.com" /></div>

3. Em **File name**, digite: **Dockerfile** e clique no bot√£o **Finish**.

<div align="center"><img width="55%" src="https://i.imgur.com/nCpNXbO.png" title="source: imgur.com" /></div>

4. Copie o c√≥digo abaixo dentro do arquivo **Dockerfile** que voc√™ criou:

```dockerfile
FROM eclipse-temurin:17-jdk AS build

WORKDIR /workspace/app

COPY mvnw .
COPY .mvn .mvn
COPY pom.xml .
COPY src src

RUN chmod -R 777 ./mvnw

RUN ./mvnw install -DskipTests

RUN mkdir -p target/dependency && (cd target/dependency; jar -xf ../*.jar)

FROM eclipse-temurin:17-jdk

VOLUME /tmp

ARG DEPENDENCY=/workspace/app/target/dependency

COPY --from=build ${DEPENDENCY}/BOOT-INF/lib /app/lib
COPY --from=build ${DEPENDENCY}/META-INF /app/META-INF
COPY --from=build ${DEPENDENCY}/BOOT-INF/classes /app

ENTRYPOINT ["java","-cp","app:app/lib/*","com.generation.blogpessoal.BlogpessoalApplication"]
```

Vamos entender o c√≥digo:

<div align="center"><img src="https://i.imgur.com/XA3Ap0P.png" title="source: imgur.com" /></div>

A Cria√ß√£o do Container √© dividida em 2 est√°gios:

1. Criar o Build da aplica√ß√£o, ou seja, gerar o arquivo JAR.
2. Executar a Aplica√ß√£o dentro do Container

> Um arquivo **JAR** √© um **formato de arquivo compactado** usado para distribuir aplica√ß√µes Java e suas depend√™ncias em um √∫nico pacote. Essencialmente um arquivo JAR √© um arquivo ZIP que cont√©m:
>
> - Classes Java compiladas (.class)
> - Recursos da aplica√ß√£o (imagens, arquivos de configura√ß√£o, etc.)
> - Metadados (arquivo MANIFEST.MF)
> - Bibliotecas e depend√™ncias
>
> O arquivo JAR facilita a distribui√ß√£o e execu√ß√£o de aplica√ß√µes Java, empacotando tudo que √© necess√°rio em um √∫nico arquivo.

Vamos detalhar as etapas:

**Etapa 01 - Build da aplica√ß√£o**

**Linha 1:** Estamos indicando que o Build da aplica√ß√£o ser√° gerado a partir de uma imagem contendo a vers√£o 17 do Java, rodando sobre o Linux numa vers√£o minimalista, ou seja, apenas o necess√°rio para executar o Java 17. Neste momento ser√° feito o download da imagem contendo o Java 17. Observe que no final do nome da imagem, temos o alias **as build**, indicando que o Java 17 ser√° executado nesta etapa em modo Build.

<br />

| <img src="https://i.imgur.com/hOgWvSc.png" title="source: imgur.com" width="80px"/> | <div align="left"> **ATEN√á√ÉO:** *Caso o seu projeto esteja utilizando outra vers√£o do Java (21, 24, entre outras), modifique a vers√£o do Java na imagem para a mesma vers√£o do seu projeto. Exemplo: eclipse-temurin:21-jdk (Java 21)*.</div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

**Linha 3:** Estamos indicando que dentro do nosso container, o Build da nossa aplica√ß√£o ser√° gerado dentro da pasta **/workspace/app**.

**Linha 5 a 8:** Copia o projeto do **Reposit√≥rio do Github** para a pasta **/workspace/app**.

**Linha 10:** Autoriza a execu√ß√£o do **Maven** (mvnw) dentro da pasta **/workspace/app**. Sem este comando, o Render devolver√° o erro: **Permission Denied! (Permiss√£o negada)**

**Linha 12:** Gera o Build da nossa aplica√ß√£o, excluindo os testes, porqu√™ em produ√ß√£o eles s√£o desnecess√°rios. Neste momento ser√° feito o download de todas as depend√™ncias do projeto do Reposit√≥rio central do Maven e o arquivo JAR ser√° criado.

**Linha 14:** Cria a pasta **target/dependency** e descompacta o arquivo JAR gerado pelo Maven. Ao descompactar o JAR do Spring Boot, s√£o extra√≠dos e organizados os componentes da aplica√ß√£o: as classes compiladas da aplica√ß√£o, as bibliotecas de depend√™ncias e os arquivos de metadados, preparando-os para serem copiados de forma otimizada para a imagem final de execu√ß√£o.

> No contexto de uma aplica√ß√£o Spring Boot e arquivos JAR, os **metadados** s√£o informa√ß√µes descritivas sobre a aplica√ß√£o e sua estrutura, tais como:
>
> - Informa√ß√µes sobre a vers√£o da aplica√ß√£o;
> - Classe principal (Main-Class) a ser executada;
> - Vers√£o do Java utilizada;
> - Informa√ß√µes sobre o Spring Boot;
> - Entre outras.

<br />

**Etapa 02 - Executar aplica√ß√£o**

**Linha 16:** Indica que a nossa aplica√ß√£o ser√° executada atrav√©s da imagem da vers√£o 17 do Java, que j√° foi obtida via download.

<br />

| <img src="https://i.imgur.com/hOgWvSc.png" title="source: imgur.com" width="80px"/> | <div align="left"> **ATEN√á√ÉO:** *Caso o seu projeto esteja utilizando outra vers√£o do Java (21, 24, entre outras), modifique a vers√£o do Java na imagem para a mesma vers√£o do seu projeto. Exemplo: eclipse-temurin:21-jdk (Java 21)*.</div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

**Linha 18:** Cria um volume chamado **/tmp** para armazenar os arquivos tempor√°rios.

**Linha 20:** Define uma vari√°vel chamada **DEPENDENCY** que aponta para o caminho **/workspace/app/target/dependency**, onde est√£o localizados os componentes extra√≠dos do JAR na etapa de build.

**Linha 22 a 24:** Copia os componentes da aplica√ß√£o do est√°gio de build para a imagem final: as depend√™ncias JAR v√£o para **/app/lib**, os metadados para **/app/META-INF** e as classes compiladas da aplica√ß√£o para **/app**, organizando a estrutura necess√°ria para executar a aplica√ß√£o.

**Linha 26:** Executa o projeto Blog Pessoal. 

**Importante:** A instru√ß√£o "**com.generation.blogpessoal.BlogpessoalApplication**" deve ser igual ao caminho da Classe Main da aplica√ß√£o, como mostra a imagem abaixo:

<div align="center"><img src="https://i.imgur.com/dPmctx5.png" title="source: imgur.com" /></div>

Observe na imagem acima que:

- **com.generation.blogpessoal** ü°¢ Pacote principal da aplica√ß√£o.
- **BlogpessoalApplication** ü°¢ Nome da Classe que cont√©m o m√©todo **main()**.

Salve o arquivo antes de continuar.

<br />

<div align="left"><img src="https://i.imgur.com/1fDswF4.png" title="source: imgur.com" width="30px"/> <a href="https://docs.docker.com/engine/reference/builder/" target="_blank"><b>Documenta√ß√£o: Dockerfile</b></a></div>

<div align="left"><img src="https://i.imgur.com/S4GYUIM.png" title="source: imgur.com" width="30px"/> <a href="https://maven.apache.org/wrapper/" target="_blank"><b>Documenta√ß√£o: Maven Wrapper - MVNW</b></a></div>

<div align="left"><img src="https://i.imgur.com/PuWeuww.png" title="source: imgur.com" width="30px"/> <a href="https://www.guiafoca.org/guiaonline/iniciante/ch11s07.html" target="_blank"><b>Documenta√ß√£o: Linux - CHMOD</b></a></div>

<br />

<div align="left"><img src="https://i.imgur.com/JACNZiR.png" title="source: imgur.com" width="30px"/> <a href="https://github.com/rafaelq80/backend_blogpessoal_v3/tree/18_Deploy" target="_blank"><b>C√≥digo fonte do Projeto finalizado</b></a></div>

<br />

## üë£ Passo 07 - Atualizar o reposit√≥rio do projeto no Github



1. Envie as atualiza√ß√µes do seu projeto para o reposit√≥rio do  Github, atrav√©s do **Git Bash**, utilizando os comandos abaixo:

   ```bash
    git add .
    
    git commit -m ‚Äú:rocket: Deploy do Projeto Blog Pessoal‚Äù
    
    git push origin main
    
   ```

<br />

| <img src="https://i.imgur.com/hOgWvSc.png" title="source: imgur.com" width="400px"/> | <div align="left"> **ATEN√á√ÉO:** *Para efetuar o Deploy, o projeto Spring OBRIGATORIAMENTE precisa estar em um Reposit√≥rio EXCLUSIVO e n√£o pode estar DENTRO DE UMA PASTA, ou seja, ao abrir o reposit√≥rio do projeto no Github, o conte√∫do exibido ser√° semelhante ao da imagem abaixo. Outro ponto importante √© que o arquivo Dockerfile deve estar na raiz do projeto*.</div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

<div align="center"><img src="https://i.imgur.com/hPHv0ye.png" title="source: imgur.com" /></div>

<br />

## üë£ Passo 08 - Criar o Banco de dados no Render



1. Para adicionar um novo **Banco de dados PostgresSQL**, no Dashboard do Render, clique no link **New Postgres** como mostra a imagem abaixo:

<div align="center"><img src="https://i.imgur.com/xXewYJt.png" title="source: imgur.com" /></div>

<br />

| <img src="https://i.imgur.com/hOgWvSc.png" title="source: imgur.com" width="100px"/> | <p align="justify"> **ATEN√á√ÉO:** O Plano Gratuito do Render autoriza a cria√ß√£o de apenas 1 Banco de dados PostgresSQL por conta. Outro ponto importante √© que em 30 dias o Banco dados ser√° bloqueado, ou seja, para continuar rodando aplica√ß√£o ser√° necess√°rio recriar o Banco de dados e Reconfigurar a conex√£o com o Banco de dados no Webservice. </p> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

2. Na janela **Configure anda deploy your new Database**, informe o nome do Banco de dados (**db_blogpessoal**), na propriedade **Name**, como mostra a imagem abaixo:

<div align="center"><img src="https://i.imgur.com/A1uIS2V.png" title="source: imgur.com" /></div>

3. Role a tela para baixo, localize o item **Plan Options** e verifique se o Plano Gratuito (**Free**) est√° selecionado, como mostra a imagem abaixo:

<div align="center"><img src="https://i.imgur.com/8I9A6m6.png" title="source: imgur.com" /></div>

<br />

| <img src="https://i.imgur.com/hOgWvSc.png" title="source: imgur.com" width="80px"/> | <p align="justify"> **ATEN√á√ÉO:** *Caso seja selecionado um plano diferente, o Render exigir√° o Cart√£o de Cr√©dito para emitir a fatura do servi√ßo. </p> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

4. Role a tela para baixo e clique no bot√£o **Create Database** para criar o Banco de dados, como mostra a imagem abaixo: 

<div align="center"><img src="https://i.imgur.com/2BWUX1j.png" title="source: imgur.com" /></div>

5. Na pr√≥xima tela, no item **Info**, aguarde at√© que o **Status** esteja **Available**, como mostra a imagem abaixo:

<div align="center"><img src="https://i.imgur.com/YLcHAbL.png" title="source: imgur.com" /></div>

<br />

| <img src="https://i.imgur.com/hOgWvSc.png" title="source: imgur.com" width="100px"/> | <p align="justify"> **ATEN√á√ÉO:** *O processo do Deploy enviar√° apenas a sua aplica√ß√£o para a nuvem, logo o Banco de dados que ser√° criado nesta etapa estar√° vazio. </p> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

## üë£ Passo 09 - Criar o Web Service no Render



1. Volte para o **Dashboard** do Render, clicando no logo do Render, localizado no lado esquerdo da Barra de navega√ß√£o superior, como mostra a imagem abaixo:

<div align="center"><img src="https://i.imgur.com/C0qs5WO.png" title="source: imgur.com" /></div>

2. Ser√° aberta a janela **Projects** dentro do **Dashboard**, como mostra a imagem abaixo:

<div align="center"><img src="https://i.imgur.com/Egr7DfO.png" title="source: imgur.com" /></div>

3. Para adicionar um novo **Web Service**, no **Dashboard** do Render, clique no bot√£o **+ Add new**, localizado no canto superior esquerdo, e em seguida clique na op√ß√£o **Web Service**, como mostra a imagem abaixo:

<div align="center"><img src="https://i.imgur.com/CZ9YmcY.png" title="source: imgur.com" /></div>

4. Na janela **You are deploying a Web Service**, clique no bot√£o **GitHub**, como mostra a imagem abaixo:

<div align="center"><img src="https://i.imgur.com/7qiuwnM.png" title="source: imgur.com" /></div>

5. Ser√° aberto um popup com a tela **Install Render**, clique no bot√£o **Install**, para concordar que o Render acesse a sua Conta do Github.

<div align="center"><img src="https://i.imgur.com/LfygIY2.png" title="source: imgur.com" /></div>

6. Na janela **Confirm access**, digite a sua senha do Github para confirmar e clique no bot√£o **Confirm**, como mostra a imagem abaixo:

<div align="center"><img src="https://i.imgur.com/XYHRcu9.png" title="source: imgur.com" /></div>

7. De volta a janela **You are deploying a Web Service**, clique sobre o Reposit√≥rio onde voc√™ enviou o **Projeto Blog Pessoal**, para selecion√°-lo e configurar o deploy, como mostra a imagem abaixo:

<div align="center"><img src="https://i.imgur.com/n174hmO.png" title="source: imgur.com" /></div>

8. Role para baixo e informe o nome da sua aplica√ß√£o na propriedade **Name** (blogpessoal), como mostra a imagem abaixo:

<div align="center"><img src="https://i.imgur.com/gFbZ8D5.png" title="source: imgur.com" /></div>

<br />

| <img src="https://i.imgur.com/hOgWvSc.png" title="source: imgur.com" width="120px"/> | <p align="justify"> **ATEN√á√ÉO:** O NOME DO PROJETO N√ÉO PODE CONTER LETRAS MAIUSCULAS, NUMEROS OU CARACTERES ESPECIAIS. </p> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

9. Role para baixo e verifique se a propriedade **Language** est√° com a op√ß√£o **Docker** selecionada, como mostra a imagem abaixo:

<div align="center"><img src="https://i.imgur.com/IyHWJwc.png" title="source: imgur.com" /></div>

10. Role a tela para baixo, localize o item **Instance Type** e verifique se o Plano Gratuito (**Free**) est√° selecionado, como mostra a imagem abaixo:

<div align="center"><img src="https://i.imgur.com/qj1HUg2.png" title="source: imgur.com" /></div>

<br />

| <img src="https://i.imgur.com/hOgWvSc.png" title="source: imgur.com" width="80px"/> | <p align="justify"> **ATEN√á√ÉO:** Caso seja selecionado um plano diferente, o Render exigir√° o Cart√£o de Cr√©dito para emitir a fatura do servi√ßo. </p> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

## üë£ Passo 10 - Configurar as Vari√°veis de Ambiente



Nesta etapa, ser√£o criadas 5 vari√°veis de ambiente, como mostra a imagem abaixo:

<div align="center"><img src="https://i.imgur.com/pLa3OXo.png" title="source: imgur.com" /></div>

Estas 5 Vari√°veis de Ambiente ser√£o utilizadas para conectar a aplica√ß√£o com o Banco de dados do Render.

Antes de criarmos as vari√°veis, precisamos identificar os dados que ser√£o inseridos nestas vari√°veis, que est√£o dispon√≠veis no **Banco de dados** criado no passo anterior. 

1. Clique com bot√£o direito do mouse no logo do Render, localizado no lado esquerdo da Barra de navega√ß√£o superior, como mostra a imagem abaixo e clique na op√ß√£o **Abrir link em uma nova guia**:

<div align="center"><img src="https://i.imgur.com/4xi6lgz.png" title="source: imgur.com" /></div>

2. Na nova guia, ser√° aberta a janela **Projects**. Role a tela para baixo, localize o item **Ungrouped Service** e clique no Banco de dados **db_blogpessoal**, como mostra a imagem abaixo:

<div align="center"><img src="https://i.imgur.com/o1vLGpS.png" title="source: imgur.com" /></div>

3. Role a tela para baixo e localize o item: **Connections**, como mostra a imagem abaixo:

<div align="center"><img src="https://i.imgur.com/pJ6U49v.png" title="source: imgur.com" /></div>

4. Na imagem abaixo, est√° indicada qual vari√°vel receber√° cada item da configura√ß√£o do Banco de dados na nuvem:

<div align="center"><img src="https://i.imgur.com/khg9pmy.png" title="source: imgur.com" /></div>

5. Ao criar a vari√°vel **POSTGRESHOST**, acrescente no final do **Hostname**: ***.oregon-postgres.render.com***. Caso contr√°rio o Spring n√£o conectar√° com o banco de dados. 

> üëâ**Exemplo**
>
> **Hostname:** `dpg-d0r7ojvdiees73bp325g-a`
>
> **Servidor:** `oregon`
>
> **Endere√ßo do Host:**  `dpg-d0r7ojvdiees73bp325g-a.oregon-postgres.render.com`

6. Caso voc√™ tenha utilizado outro servidor do Render (diferente do Oregon), siga a tabela abaixo:

| Servidor     | Complemento do endere√ßo do Host |
| ------------ | ------------------------------- |
| **Ohio**     | `.ohio-postgres.render.com`     |
| **Virginia** | `.virginia-postgres.render.com` |

7. Nas demais vari√°veis, utilize os mesmos dados que est√£o no item **Connections** do Banco de dados.
8. No exemplo acima, a configura√ß√£o ficou da seguinte forma:

| Vari√°vel             | Conte√∫do                                                |
| -------------------- | ------------------------------------------------------- |
| **POSTGRESHOST**     | *dpg-d0r7ojvdiees73bp325g-a.oregon-postgres.render.com* |
| **POSTGRESPORT**     | *5432*                                                  |
| **POSTGRESDATABASE** | *db_blogpessoal_d4zu*                                   |
| **POSTGRESUSER**     | *db_blogpessoal_d4zu_user*                              |
| **POSTGRESPASSWORD** | *senha do banco de dados*                               |

Agora vamos criar as vari√°veis:

1. Volte para a Guia do Navegador onde o **Web Service** est√° sendo criado, role a tela para baixo e localize o item **Environment Variables**, como mostra a imagem abaixo:

<div align="center"><img src="https://i.imgur.com/VL0Hn8o.png" title="source: imgur.com" /></div>

2. Na propriedade **NAME_OF_VARIABLE**, informe o nome da 1¬™ vari√°vel: **POSTGRESHOST**

<div align="center"><img src="https://i.imgur.com/ElwSZvM.png" title="source: imgur.com" /></div>

3. Na propriedade **Value** da Vari√°vel de Ambiente **POSTGRESHOST**, cole o Hostname do Banco de dados, conforme detalhado nos itens acima, como mostra a imagem abaixo:

<div align="center"><img src="https://i.imgur.com/uyIXKZX.png" title="source: imgur.com" /></div>

4. Para adicionar uma nova vari√°vel de ambiente, clique no bot√£o **+ Add Environment Variable**

<div align="center"><img src="https://i.imgur.com/B4AIoFR.png" title="source: imgur.com" /></div>

5. **Repita os passos 2 a 4** para criar as demais vari√°veis.
6. Ao final, voc√™ ter√° as 5 Vari√°veis de Ambiente Configuradas, como mostra a imagem abaixo:

<div align="center"><img src="https://i.imgur.com/pLa3OXo.png" title="source: imgur.com" /></div>

7. Depois de criar as Variaveis de Ambiente, role a tela para baixo e clique no bot√£o **Create Web Service** para criar o Web Service e iniciar o Deploy.

<div align="center"><img src="https://i.imgur.com/n5iz2v5.png" title="source: imgur.com" /></div>

8. Na pr√≥xima janela, voc√™ pode acompanhar o processo do Deploy atrav√©s da janela do **Log do Web Service**, como mostra a imagem abaixo:

<div align="center"><img src="https://i.imgur.com/LxGwAcp.png" title="source: imgur.com" /></div>

9. Ao terminar o deploy, a aplica√ß√£o ser√° inicializada, de forma semelhante ao STS. Observe se a aplica√ß√£o inicializa sem erros e se no final ser√° exibida a mensagem informando que a aplica√ß√£o est√° em execu√ß√£o. 

<div align="center"><img src="https://i.imgur.com/pw49VtD.png" title="source: imgur.com" /></div>

10. Para **confirmar que o Deploy foi conclu√≠do com √™xito**, verifique na parte superior da tela de **Log do Webservice**, se apareceu a mensagem **Live**, como mostra a figura abaixo:

<div align="center"><img src="https://i.imgur.com/HGqhAh4.png" title="source: imgur.com" /></div>

11. Se apareceu esta mensagem, o Deploy foi finalizado com sucesso!
12. Para abrir a aplica√ß√£o no Navegador da Internet, clique no link da aplica√ß√£o, indicado na imagem abaixo:

<div align="center"><img src="https://i.imgur.com/1FTvC99.png" title="source: imgur.com" /></div>

<br />

| <img src="https://i.imgur.com/hOgWvSc.png" title="source: imgur.com" width="100px"/> | <p align="justify"> **ATEN√á√ÉO:** Ao clicar no link da aplica√ß√£o, o projeto pode n√£o abrir automaticamente no navegador. Como o Docker precisa finalizar alguns processos, ele pode demorar alguns minutos para abrir. O tempo m√©dio do processo de deploy completo do Blog Pessoal pode demorar um pouco.</p> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

| <img src="https://i.imgur.com/vVDBDG0.png" title="source: imgur.com" width="100px"/> | <p align="justify"> **ALERTA DE BSM:** *Mantenha a aten√ß√£o aos detalhes. Caso o nome do projeto j√° seja um endere√ßo em uso no Render, ele acrescentar√° caracteres aleat√≥rios depois do nome do projeto ao criar o endere√ßo da aplica√ß√£o. Exemplo: blogpessoal-wrtc.onrender.com*. </p> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

## üë£ Passo 11 - Abrir o Deploy no Navegador



1. Ao abrir a sua aplica√ß√£o no Navegador, ser√° exibida a tela de login abaixo. Como o Banco de dados criado no Render est√° vazio, precisamos criar uma conta de usu√°rio e efetuar o login com esta conta antes de exibir a sua documenta√ß√£o no Swagger. 

<div align="center"><img src="https://i.imgur.com/MTFkYZb.png" title="source: imgur.com" /></div>

2. Abra o **Insomnia** e acesse a Collection **Blog Pessoal**.

3. Dentro da Collection  **Blog Pessoal**, crie uma pasta chamada **Local** e arraste as 3 pastas (Postagem, Tema e Usuario) para dentro dela, como mostra a imagem abaixo:

<div align="center"><img src="https://i.imgur.com/FYnkUBn.png" title="source: imgur.com" /></div>

4. Na sequ√™ncia, Duplique a pasta **Local**, clicando na seta ao lado da pasta

<div align="center"><img src="https://i.imgur.com/u8HBMke.png" title="source: imgur.com" /></div>

5. Ao clicar nesta pasta, ser√° aberto um menu. Clique na op√ß√£o **Duplicate**:

<div align="center"><img src="https://i.imgur.com/4aL9wKD.png" title="source: imgur.com" /></div>

6. Na janela **Duplicate Folder**, defina o nome da nova pasta como **Render**.

<div align="center"><img src="https://i.imgur.com/X3z2qD7.png" title="source: imgur.com" /></div>

7. Abra a requisi√ß√£o **Cadastrar Usu√°rio** da pasta **Render**.
8. Altere o endere√ßo local (URL) atual: **http://localhost:8080/usuarios/cadastrar** 

<div align="center"><img src="https://i.imgur.com/0zGznXO.png" title="source: imgur.com" /></div>

9. Para o endere√ßo do Render (Remoto) do seu Deploy: https://meuprojeto.onrender.com/usuarios/cadastrar (No exemplo acima: https://blogpessoal.onrender.com/usuarios/cadastrar)

<div align="center"><img src="https://i.imgur.com/HmopPqF.png" title="source: imgur.com" /></div>

10. Ap√≥s efetuar as altera√ß√µes, crie o usu√°rio **root@root.com** com os dados da imagem abaixo:

<div align="center"><img src="https://i.imgur.com/3GD5gh1.png" title="source: imgur.com" /></div>

<br />

| <img src="https://i.imgur.com/vVDBDG0.png" title="source: imgur.com" width="100px"/> | <p align="justify"> **ALERTA DE BSM:** *Mantenha a aten√ß√£o aos detalhes. Crie o usu√°rio root exatamente como mostra a figura acima. Ser√° atrav√©s deste usu√°rio que os Instrutores da sua turma ir√£o corrigir o seu projeto*. </p> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

11. Volte para o Navegador da Internet e efetue o login com o usu√°rio **root@root.com**.

<div align="center"><img src="https://i.imgur.com/A3NXaGE.png" title="source: imgur.com" /></div>

12. A Documenta√ß√£o no Swagger ser√° exibida como a p√°gina inicial.

<div align="center"><img src="https://i.imgur.com/SJHPYNu.png" title="source: imgur.com"/></div>

<br />

## üë£ Passo 12 - Testar o Deploy no Insomnia



1. Volte para o **Insomnia** 

2. **Atualize o Endere√ßo de todas as Requisi√ß√µes** da pasta **Render**, assim como foi feito na requisi√ß√£o **Cadastrar Usu√°rio**

3. Antes de come√ßar a testar todas Requisi√ß√µes do Deploy no Render, Fa√ßa o login utilizando o usu√°rio cadastrado **root@root.com**, atrav√©s da Requisi√ß√£o **Autenticar Usu√°rio**, da pasta **Render**, para obter o Token.

4. **Atualize o Token de todas as Requisi√ß√µes protegidas**. 

5. Teste todas Requisi√ß√µes.

<br />

| <img src="https://i.imgur.com/vVDBDG0.png" title="source: imgur.com" width="200px"/> | <p align="justify"> **ALERTA DE BSM:** *Mantenha a aten√ß√£o aos detalhes e a persist√™ncia. Insira dados na API atrav√©s do Insomnia em todos os recursos (Postagem, Tema e Usuario) e teste todos os Endpoints. No recurso Postagem, n√£o esque√ßa de testar o Relacionamento entre as Classes Postagem, Tema e Usuario*. </p> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

## 3. O Deploy Falhou!

<br />

| <img src="https://i.imgur.com/vVDBDG0.png" title="source: imgur.com" width="80px"/> | <p align="justify"> **ALERTA DE BSM:** *Mantenha a aten√ß√£o aos detalhes. Este item voc√™ utilizar√° apenas se o seu Deploy falhar*. </p> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

### 3.1. O Deploy n√£o abre no Navegador

-  Se o **Console** indica que a aplica√ß√£o subiu, S**tarted BlogpessoalApplication in 15.456 seconds (JVM running for 20.59)**, mas ao abrir a aplica√ß√£o no Navegador aparece a mensagem abaixo:

<div align="center"><img src="https://i.imgur.com/AlKoYkc.png" title="source: imgur.com" /></div>

- Clique no bot√£o **Manual Deploy** e em seguida, clique na op√ß√£o **Clear build cache & deploy** para refazer o deploy, como mostra a imagem abaixo:

<div align="center"><img src="https://i.imgur.com/xngS8Aq.png" title="source: imgur.com" /></div>

- Aguarde a conclus√£o e tente abrir novamente

<br />

### 3.2. O Deploy Falhou

- Se aparecer a mensagem **Failed**, como mostra a figura abaixo:

<div align="center"><img src="https://i.imgur.com/7SaAc4l.png" title="source: imgur.com" /></div>

- Caso n√£o tenha aparecido mensagens de erro no **Console, na tela Log do Webservice** (O projeto Spring inicializou, mas o deploy falhou), clique no bot√£o **Manual Deploy** e em seguida, clique na op√ß√£o **Clear build cache & deploy** para refazer o deploy, como mostra a imagem abaixo:

<div align="center"><img src="https://i.imgur.com/xngS8Aq.png" title="source: imgur.com" /></div>

- Se o erro persistir, verifique se as **Vari√°veis de Ambiente est√£o configuradas corretamente**. Caso seja necess√°rio atualizar o valor de qualquer Vari√°vel de ambiente, o Render iniciar√° um novo Deploy automaticamente ap√≥s a atualiza√ß√£o;
- Caso tenha aparecido algum erro no **Log do Web Service**, identifique o tipo do erro:
  - Se for erro no **Dockerfile**, corrija o erro e atualize o seu reposit√≥rio no Github;
  - Se for erro de c√≥digo (erro do Spring), siga as instru√ß√µes do t√≥pico: <a href="#update">**3. Como atualizar o Deploy no Render?**</a> e corrija o erro.

<br />

## 4. Como atualizar o Deploy no Render?

<br />

| <img src="https://i.imgur.com/vVDBDG0.png" title="source: imgur.com" width="100px"/> | <p align="justify"> **ALERTA DE BSM:** *Mantenha a aten√ß√£o aos detalhes. Este item voc√™ utilizar√° apenas se voc√™ precisar alterar alguma coisa no seu projeto Spring e atualizar  a aplica√ß√£o na nuvem*. </p> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

1. Para fazer altera√ß√µes no c√≥digo do projeto e executar localmente, volte para o **STS** e altere a primeira linha do arquivo, **application.properties** conforme o c√≥digo abaixo:

```properties
spring.profiles.active=dev
```

2. Fa√ßa as altera√ß√µes necess√°rias no c√≥digo do seu projeto, execute localmente e verifique se est√° tudo funcionando **sem erros**.

3. Antes de refazer o Deploy, altere novamente a primeira linha do arquivo, **application.properties** conforme o c√≥digo abaixo:

```properties
spring.profiles.active=prod
```

4.  Envie as atualiza√ß√µes do seu projeto para o reposit√≥rio do  Github, atrav√©s do **Git Bash**, utilizando os comandos abaixo: 

```bash
git add .
git commit -m ‚ÄúAtualiza√ß√£o do Deploy - Blog Pessoal‚Äù
git push origin main
```

5. Ao finalizar o **git push**, o Render come√ßar√° a refazer o Deploy. Acompanhe o processo pelo **Dashboard do Render**. 

<div align="center"><img src="https://i.imgur.com/mCxUqQy.png" title="source: imgur.com" /></div>

6. Verifique se a Aplica√ß√£o abre no Navegador e fa√ßa os testes no Insomnia.

<br /><br />

<div align="left"><a href="README.md"><img src="https://i.imgur.com/XMgF3gl.png" title="source: imgur.com" width="3%"/>Voltar</a></div>
