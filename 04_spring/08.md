<h1>Projeto 02 - Blog Pessoal - Classe PostagemController - M√©todo Consultar Postagens por Id</h1>

O que veremos por aqui:

1. Criar o M√©todo getById(Long id) para listar uma Postagem espec√≠fica

<h2>1. O Recurso Postagem</h2>

Na etapa anterior, come√ßamos a construir a Classe **PostagemController** e implementamos o M√©todo **getAll()**, que retorna todos os Objetos da Classe Postagem persistidos no Banco de dados. Vamos continuar a constru√ß√£o da nossa Classe Controladora implementando o **M√©todo getById( Long id )**.

<div align="center"><img src="https://i.imgur.com/aKmFiA1.png" title="source: imgur.com" width="50%"/></div>

<h2>üë£ Passo 01 - Criar o M√©todo getById(Long id)</h2>

Vamos implementar o M√©todo **getById(Long id)** na Classe Postagem Controller, que retornar√° um Objeto espec√≠fico persistido no Banco de dados, identificado pelo **id** (Identificador √∫nico do Objeto). Tra√ßando um paralelo com o MySQL, seria o equivalente a instru√ß√£o: <code>SELECT * FROM tb_postagens where id = id;</code>.

<div align="left"><img src="https://i.imgur.com/kpnrys7.png" title="source: imgur.com" /></div>

Para processar o M√©todo findById(Long id), vamos utilizar dois recursos da Linguagem Java, que tornam o c√≥digo mais limpo e assertivo. S√£o os recursos **Optional e Express√µes Lambda**.

**Optional (map):** √â um cont√™iner para um valor que pode estar ausente. Em nosso contexto, tem como principal fun√ß√£o evitar o erro do tipo **NullPointerException** (Objeto nulo), caso o Objeto Postagem procurado pelo M√©todo findById(id) n√£o seja encontrado. O retorno do M√©todo N√ÉO pode ser nulo, por isso fazemos uso do Optional para que ele fa√ßa o encapsulamento e informe se o Objeto est√° presente ou n√£o.

**Express√µes Lambda**: Representam uma fun√ß√£o an√¥nima, ou seja, uma fun√ß√£o lambda √© uma fun√ß√£o sem declara√ß√£o, ou seja, n√£o √© necess√°rio colocar um nome, um tipo de retorno e modificador de acesso. A ideia √© que o M√©todo seja declarado no mesmo lugar em que ser√° usado e a sua declara√ß√£o seja impl√≠cita. As express√µes lambda em Java tem a sintaxe definida como: (argumento) ü°™  (corpo). A Linguagem **Javascript/Typescript** possuem um recurso semelhante, que s√£o as **Arrow Functions**.

**Linha 30:** A anota√ß√£o **@GetMapping("/{id}")** mapeia todas as Requisi√ß√µes **HTTP GET**, enviadas para um endere√ßo espec√≠fico (**Endpoint**), dentro do Recurso Postagem, para um M√©todo espec√≠fico que responder√° as requisi√ß√µes, ou seja, ele indica que o M√©todo **getById( Long id )**, responder√° a todas as requisi√ß√µes do tipo **HTTP GET**, enviadas no endere√ßo **http://localhost:8080/postagens/id**, onde **id** √© uma **Vari√°vel de Caminho** (Path Variable), que receber√° o id da Postagem que ser√° Consultada.

| <img src="https://i.imgur.com/hOgWvSc.png" title="source: imgur.com" width="250px"/> | <div align="left"> **ATEN√á√ÉO:** *O Endere√ßo deste Endpoint ser√° composto pelo Endere√ßo do Recurso (@RequestMapping) + a vari√°vel de caminho indicada na anota√ß√£o @GetMapping. Lembre-se que n√£o pode existir dois ou mais M√©todos do tipo GET com o mesmo endere√ßo.* </div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

**Linha 31:** O M√©todo **getById(@PathVariable Long id)** ser√° do tipo **ResponseEntity** porque ele responder√° Requisi√ß√µes HTTP (HTTP Request), com uma **Resposta HTTP** (HTTP Response). Observe que o M√©todo possui um par√¢metro do tipo **Long**, chamado **id**.

**@PathVariable Long id:** Esta anota√ß√£o insere o valor enviado no endere√ßo do endpoint, na Vari√°vel de Caminho **{id}**, no par√¢metro do M√©todo **getById( Long id )**;

**Exemplo:**

http://localhost:8080/postagens/1

Neste exemplo, o par√¢metro **Long id**, do M√©todo getById( Long id ), receber√° o valor 1 (Id que ser√° procurado em tb_postagens)

| <img src="https://i.imgur.com/hOgWvSc.png" title="source: imgur.com" width="150px"/> | <div align="left"> **ATEN√á√ÉO:** *Por quest√µes de boas pr√°ticas e legibilidade do c√≥digo, a Vari√°vel de Caminho e o Par√¢metro do M√©todo getById devem possuir o mesmo nome.* </div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<img src="https://i.imgur.com/QKIS6Rm.png" title="source: imgur.com" height="20px"/>: O M√©todo al√©m de retornar um objeto da **Classe ResponseEntity** (OKü°™200), no par√¢metro Body (Corpo da Resposta), ser√° retornado **Um Objeto da Classe Postagem**, apenas e somente se o Objeto procurado for encontrado no Banco de dados, na tabela **tb_postagens**. Observe que nesta linha tamb√©m foi utilizado o recurso **Java Generics** para simplificar o retorno do Objeto. 

**Linha 32:**

**return postagemRepository.findById(Long id):** Retorna a execu√ß√£o do M√©todo **findById(id)**, que √© um  **M√©todo padr√£o da Interface JpaRepository**. O M√©todo retornar√° **um Objeto da Classe Postagem** persistido no Banco de dados (<img src="https://i.imgur.com/QKIS6Rm.png" title="source: imgur.com" height="20px"/>), caso ele seja encontrado a partir do par√¢metro Long id. Caso contr√°rio, ser√° retornado um Objeto Nulo.

**.map(resposta ü°™ ResponseEntity.ok(resposta)):** Se o Objeto da Classe Postagem for econtrado, o M√©todo **map** (Optional), mapeia no **Objeto  resp** o Objeto Postagem retornado pelo M√©todo findById(id)), insere o Objeto mapeado no Corpo da Resposta do M√©todo **ResponseEntity.ok(resp);** e retorna o HTTP Status **OKü°™200**.

**.orElse(ResponseEntity.notFound().build());:** Se o Objeto Postagem n√£o for encontrado (Nulo), ser√° retornado o HTTP Status **NOT FOUND ü°™ 404** (N√£o Encontrado!). O M√©todo **build()** constr√≥i a Resposta com o HTTP Status retornado.

Para concluir, n√£o esque√ßa de Salvar o c√≥digo (**File ü°™ Save All**) e verificar se o Projeto est√° em execu√ß√£o.

<br />

<div align="left"><img src="https://i.imgur.com/sv8IEe1.png" title="source: imgur.com" width="25px"/> <a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/bind/annotation/GetMapping.html" target="_blank"><b>Documenta√ß√£o: <i>@GetMapping</i></b></a></div>

<div align="left"><img src="https://i.imgur.com/sv8IEe1.png" title="source: imgur.com" width="25px"/> <a href="https://www.baeldung.com/spring-pathvariable" target="_blank"><b>Documenta√ß√£o: <i>@PathVariable</i></b></a></div>

<div align="left"><img src="https://i.imgur.com/sv8IEe1.png" title="source: imgur.com" width="25px"/> <a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/http/ResponseEntity.html#ok-T-" target="_blank"><b>Documenta√ß√£o: <i>ResponseEntity</i></b></a></div>

<div align="left"><img src="https://i.imgur.com/sv8IEe1.png" title="source: imgur.com" width="25px"/> <a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/http/HttpStatus.html" target="_blank"><b>Documenta√ß√£o: <i>HttpStatus</i></b></a></div>

<div align="left"><img src="https://i.imgur.com/sv8IEe1.png" title="source: imgur.com" width="25px"/> <a href="https://docs.spring.io/spring-data/commons/docs/current/api/org/springframework/data/repository/CrudRepository.html#findById-ID-" target="_blank"><b>Documenta√ß√£o: <i>.findById(Long id)</i></b></a></div>

<div align="left"><img src="https://i.imgur.com/JSfXyzm.png" title="source: imgur.com" width="25px"/> <a href="https://docs.google.com/document/d/1IQwgepFjSVCsMWiLHCidJyAj3jF2xp5h/edit" target="_blank"><b>Documenta√ß√£o: <i>Optional</i></b></a></div>

<div align="left"><img src="https://i.imgur.com/JSfXyzm.png" title="source: imgur.com" width="25px"/> <a href="https://docs.oracle.com/javase/tutorial/java/javaOO/lambdaexpressions.html" target="_blank"><b>Documenta√ß√£o: <i>Express√µes Lambda</i></b></a></div>

<div align="left"><img src="https://i.imgur.com/JSfXyzm.png" title="source: imgur.com" width="25px"/> <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Long.html" target="_blank"><b>Documenta√ß√£o: <i>Long</i></b></a></div>

<div align="left"><img src="https://i.imgur.com/JSfXyzm.png" title="source: imgur.com" width="25px"/> <a href="https://www.w3schools.com/java/java_wrapper_Classes.asp" target="_blank"><b>Artigo: <i>Classes Wrappers (Long)</i></b></a></div>

<br />

<div align="left"><img src="https://i.imgur.com/JACNZiR.png" title="source: imgur.com" width="25px"/> <a href="https://github.com/conteudoGeneration/backend_blog_pessoal/blob/05-blog_pessoal_crud_05/blogpessoal/src/main/java/com/generation/blogpessoal/controller/PostagemController.java" target="_blank"><b>C√≥digo fonte da Classe PostagemController</b></a></div>


<br />

<h2>üë£ Passo 02 - Testar no Insomnia</h2>

Agora vamos criar a Requisi√ß√£o para o **M√©todo getById()**:

1. Clique com o bot√£o direito do mouse sobre a **Pasta Postagem** para abrir o menu e clique na op√ß√£o **New Request**.

<div align="center"><img src="https://i.imgur.com/bFUVP3h.png" title="source: imgur.com" /></div>

2. Ser√° criada uma nova Requisi√ß√£o (New Request) dentro da pasta **Postagem**.

   <div align="center"><img src="https://i.imgur.com/CA70WQn.png" title="source: imgur.com" /></div>

3. D√™ um duplo clique sobre a nova requisi√ß√£o (**New Request**), informe o nome da requisi√ß√£o (indicado na imagem abaixo na cor amarela) e pressione a tecla **enter** do seu teclado.

<div align="center"><img src="https://i.imgur.com/reMehb6.png" title="source: imgur.com" /></div>

4. Selecione o M√©todo HTTP que ser√° utilizado (**GET**) na requisi√ß√£o, indicado na imagem abaixo na cor verde. 

<div align="center"><img src="https://i.imgur.com/mWPpKHD.png" title="source: imgur.com" /></div>

5. Configure a requisi√ß√£o conforme a imagem abaixo:

<div align="center"><img src="https://i.imgur.com/8TEvnhM.png" title="source: imgur.com" /></div>

4. No item marcado em amarelo na imagem acima, informe o endere√ßo (endpoint) da Requisi√ß√£o. A requisi√ß√£o **Consultar postagem por ID** foi configurada da seguinte maneira:

- A primeira parte do endere√ßo (http://localhost:8080) √© o endere√ßo do nosso servidor local. Quando a API estiver na nuvem, ele ser√° substitu√≠do pelo endere√ßo da aplica√ß√£o na nuvem (http://nomedaaplicacao.herokuapp.com).
- A segunda parte do endere√ßo √© o **Endpoint** configurado na anota√ß√£o ***@RequestMapping***, em nosso caso  **/postagens**. 
- A terceira parte (**/1**) √© a vari√°vel de caminho (**@PathVariable**) **id**. Informe o id que voc√™ deseja procurar.

5. Para testar a requisi√ß√£o, com a aplica√ß√£o rodando, clique no bot√£o <img src="https://i.imgur.com/sy0V8Nx.png" title="source: imgur.com" width="60px"/>.

6. O resultado da requisi√ß√£o voc√™ confere na imagem abaixo:

<div align="center"><img src="https://i.imgur.com/2T5jK4E.png" title="source: imgur.com" /></div>

7. Observe que a aplica√ß√£o quando encontra o Objeto no Banco de dados, al√©m de exibir os dados do Objeto no Corpo da Resposta, respeitando o crit√©rio informado na consulta (id 1), ela tamb√©m retorna um **HTTP Status 200 ü°™ OK** (indicado em verde na imagem acima), informando que a Requisi√ß√£o foi bem sucedida!

8. Caso o Objeto Postagem n√£o seja encontrado, a aplica√ß√£o retornar√° o **HTTP Status 404 ü°™ NOT FOUND** (N√£o encontrado), marcado em laranja na imagem abaixo:

<div align="center"><img src="https://i.imgur.com/5lCAhBv.png" title="source: imgur.com" /></div>

<br />

<div align="left"><img src="https://i.imgur.com/JACNZiR.png" title="source: imgur.com" width="25px"/> <a href="https://github.com/conteudoGeneration/backend_blog_pessoal/tree/05-blog_pessoal_crud_05" target="_blank"><b>C√≥digo fonte do projeto</b></a></div>

<br /><br />
	

<div align="left"><a href="README.md"><img src="https://i.imgur.com/XMgF3gl.png" title="source: imgur.com" width="3%"/>Voltar</a></div>
