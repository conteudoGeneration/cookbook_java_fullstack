<h1>Optional</h1>



**Optional** √© uma Classe que foi implementada no Java 8, que tem o objetivo de  simplificar os c√≥digos, facilitando a vida das pessoas desenvolvedoras.

A principal proposta deste recurso √© encapsular o retorno de m√©todos e informar se um valor do tipo `<T>` (Java Generics) est√° presente ou ausente.

> **Java Generics** √© uma Classe ou Interface gen√©rica, como a Classe Optional por exemplo, que √© parametrizada por tipos espec√≠ficos, ou seja, permitem que tipos (classes e interfaces) sejam par√¢metros ao definir Classes, Interfaces e M√©todos. 
>
> O tipo espec√≠fico √© definido dentro do diamante `<T>`, onde **T** representa o tipo.  Caso um tipo n√£o seja definido, ou seja, o diamante esteja vazio `<T>` ou com uma interroga√ß√£o `<?>`, a Classe ou Interface gen√©rica aceitar√° qualquer tipo de Objeto.
>
> **Exemplo:** `Optional <String> teste`
>
> No exemplo acima foi criado um Objeto da Classe Gen√©rica Optional, chamado **teste**, que armazenar√° uma String.
>
> A principal vantagem de utilizar Java Generics √© evitar convers√µes de tipos de dados o tempo todo (cast), al√©m de deixar o c√≥digo mais limpo e intuitivo.

Fazendo uma analogia, o Optional √© como uma caixa onde guardamos (encapsulamos) um Objeto, para evitar o erro *NullPointerException*.

<div align="center"><img src="https://i.imgur.com/7JzXM53.png" title="source: imgur.com" /></div>

Sempre que precisamos deste Objeto, utilizamos os M√©todos da Classe Optional, que veremos na sequ√™ncia.

O *Optional* nos ajuda nas seguintes tarefas:

- Evitar os erros do tipo *NullPointerException*;
- Elimina a necessidade da verifica√ß√£o se um Objeto √© nulo (null), atrav√©s do condicional `if (variavel != null)`;
- Permite escrever um c√≥digo com menos linhas, mais limpo e elegante.

**Sintaxe:**

```java
// Optional com o valor vazio
Optional<String> optional = Optional.empty();

// Valor diferente nulo
Optional<String> optional = Optional.of(palavra[5]);

// Existe a probabilidade do valor ser nulo
Optional<String> optional = Optional.ofNullable(palavra[5]);

```

Como vimos acima, existem 3 M√©todos para criar um Optional:

| M√©todo           | Descri√ß√£o                                                    |
| ---------------- | ------------------------------------------------------------ |
| **empty()**      | Retorna uma inst√¢ncia do `Optional` vazia.                   |
| **of()**         | Retorna um `Optional` com o valor fornecido, mas o valor n√£o pode ser nulo. |
| **ofNullable()** | Se o valor estiver presente, retorna um `Optional` com o valor, caso contr√°rio, retorna um `Optional` vazio. Este √© um dos m√©todos mais indicados para criar um `Optional`, principalmente quando n√£o se tem a certeza de que o Objeto est√° ou estar√° presente. |

<br />

<h3>1.1. Principais M√©todos  da Classe Optional</h3>

| M√©todo            | Descri√ß√£o                                                    |
| ----------------- | ------------------------------------------------------------ |
| **filter()**      | Se um valor estiver presente e o valor corresponder ao crit√©rio de filtragem, ele retorna um `Optional` com o valor, se n√£o, retorna um `Optional` vazio. |
| **isPresent()**   | Checa se um valor est√° presente. Se estiver retorna `true`, se n√£o, retorna `false`. |
| **isEmpty()**     | Checa se um valor n√£o est√° presente. Se n√£o estiver presente retorna `true`, se n√£o, retorna `false`. |
| **get()**         | Se um valor estiver presente, ele retorna o valor, caso contr√°rio, lan√ßa a exce√ß√£o `NoSuchElementException`, logo para usar o `get` √© preciso ter certeza de que o `Optional` n√£o est√° vazio. |
| **ifPresent()**   | Se um valor estiver presente, executa uma a√ß√£o no valor, caso contr√°rio, n√£o faz nada. |
| **map()**         | Se um valor estiver presente retorna um `Optinal` com o resultado da aplica√ß√£o da fun√ß√£o de mapeamento no valor, caso contr√°rio, retorna um `Optional` vazio. Geralmente utilizamos o Optional em conjunto com as Express√µes Lambda. |
| **flatMap()**     | Semelhante ao `map`, se um valor estiver presente, retorna o resultado da aplica√ß√£o da fun√ß√£o de mapeamento no valor, caso contr√°rio retorna um `Optional` vazio. A diferen√ßa √© que o `flatMap` pode ser aplicado a um mapeamento que tamb√©m retorna um `Optional`. |
| **orElse()**      | Geralmente utilizado em conjunto com o **m√©todo map()** ou com o **m√©todo flatMap()**, se o resultado do **m√©todo map()** ou do **m√©todo flatMap()** for falso, ele retorna o valor definido no par√¢metro do m√©todo **orElse()**. |
| **orElseGet()**   | Geralmente utilizado em conjunto com o **m√©todo map()** ou com o **m√©todo flatMap()**, se o resultado do **m√©todo map()** ou do **m√©todo flatMap()** for falso, retorna o resultado produzido pelo par√¢metro. |
| **orElseThrow()** | Geralmente utilizado em conjunto com o **m√©todo map()** ou com o **m√©todo flatMap()**, se o resultado do **m√©todo map()** ou do **m√©todo flatMap()** for falso, lan√ßa uma exce√ß√£o informada no par√¢metro. |

<br />

<div align="left"><img src="https://i.imgur.com/JSfXyzm.png" title="source: imgur.com" width="30px"/> <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Optional.html" target="_blank"><b>Documenta√ß√£o: Classe Optional</b></a></div>

<div align="left"><img src="https://i.imgur.com/JSfXyzm.png" title="source: imgur.com" width="30px"/> <a href="https://docs.oracle.com/javase/tutorial/java/generics/types.html" target="_blank"><b>Documenta√ß√£o: Java Generics</b></a></div>

<br />


## <img src="https://i.imgur.com/gsSDe7P.png" title="source: imgur.com" width="3%"/>Exemplo 01 - C√≥digo sem o Optional

Primeiro vamos criar o c√≥digo abaixo, que ir√° causar um erro do tipo **NullPointerException**. Neste c√≥digo n√£o utilizaremos o **Optional**:

```java
package com.generation.optional01;

public class Optional01 {

	public static void main(String[] args) {
        
		String[] palavras = new String[10];
		String palavra = palavras[5].toLowerCase();
		System.out.println(palavra);
        
	}
}
```

No console ser√° exibido o erro abaixo:

<img src="https://i.imgur.com/V2ReOnx.png" title="source: imgur.com" width="3%"/>**Resultado do Algoritmo:**

```java
Exception in thread "main" java.lang.NullPointerException
```

Este erro indica que a posi√ß√£o 5 do vetor palavras √© nula, porqu√™ o vetor n√£o foi preenchido com nenhum valor.

<br />

<div align="left"><img src="https://i.imgur.com/bQGvf3h.png" title="source: imgur.com" width="25px"/> <a href="https://github.com/rafaelq80/exemplos_java/tree/main/java_optional/optional01_v1" target="_blank"><b>C√≥digo fonte do exemplo</b></a></div>

<br />

Na sequ√™ncia, vamos reescrever o c√≥digo implementando o Optional:

## <img src="https://i.imgur.com/gsSDe7P.png" title="source: imgur.com" width="3%"/>Exemplo 02 - Implementa√ß√£o do Optional

```java
package com.generation.optional01;

import java.util.Optional;

public class Optional01 {

	public static void main(String[] args) {

		String[] palavras = new String[10];

		Optional<String> checaNulo = Optional.ofNullable(palavras[5]);

		if (checaNulo.isPresent()) {
			String palavra = palavras[5].toLowerCase();
			System.out.print(palavra);
		} else
			System.out.println("A palavra √© nula!");
	}

}
```

No console ser√° exibida a mensagem abaixo:

<img src="https://i.imgur.com/V2ReOnx.png" title="source: imgur.com" width="3%"/>**Resultado do Algoritmo:**

```java
A palavra √© nula!
```

Observe que o conte√∫do da posi√ß√£o 5 do vetor palavras, foi encapsulado em um Objeto da Classe Optional, chamado **checaNulo**. Na sequ√™ncia, atrav√©s do M√©todo boolean **IsPresent()**, verificamos se o Optional possui um conte√∫do (diferente de nulo). Caso seja diferente de nulo, o conte√∫do ser√° exibido em letras min√∫sculas, atrav√©s do M√©todo **toLowerCase()** da Classe String. Caso contr√°rio, uma mensagem ***"A palavra √© nula!"*** ser√° exibida.

O Optional √© uma forma mais elegante e intuitiva de verificar se um Objeto √© nulo. Al√©m disso, oferece outros M√©todos, como veremos no pr√≥ximo exemplo:

<br />

<div align="left"><img src="https://i.imgur.com/bQGvf3h.png" title="source: imgur.com" width="25px"/> <a href="https://github.com/rafaelq80/exemplos_java/tree/main/java_optional/optional01_v2" target="_blank"><b>C√≥digo fonte do exemplo</b></a></div>

<br />

## <img src="https://i.imgur.com/gsSDe7P.png" title="source: imgur.com" width="3%"/>Exemplo 03 - Optional - M√©todos I 

Neste exemplo vamos utilizar os M√©todos **empty(), get() e IsPresent()**:

```java
package com.generation.optional02;

import java.util.Optional;

public class Optional02 {

	public static void main(String[] args) {

		String[] frases = new String[5];

		frases[2] = "Generation Brasil";
		
		Optional<String> optionalVazio = Optional.empty();
		System.out.println("\n Exibir optionalVazio: " + optionalVazio);
		System.out.println("\n optionalVazio est√° vazio? " + optionalVazio.isEmpty());

		Optional<String> valor_indice_02 = Optional.of(frases[2]);
		System.out.println("\n Exibir valor_indice_02: " + valor_indice_02);
		System.out.println("\n Obter o conte√∫do de valor_indice_02: " + valor_indice_02.get());
		System.out.println("\n valor_indice_02 est√° presente? " + valor_indice_02.isPresent());

	}

}
```

No console ser√° exibida a mensagem abaixo:

<img src="https://i.imgur.com/V2ReOnx.png" title="source: imgur.com" width="3%"/>**Resultado do Algoritmo:**

```java
Exibir optionalVazio: Optional.empty

optionalVazio est√° vazio? true

Exibir valor_indice_02: Optional[Generation Brasil]

Obter o conte√∫do de valor_indice_02: Generation Brasil

valor_indice_02 est√° presente? true
```

Observe que atrav√©s do com o M√©todo **isEmpty()** verificamos se o Optional **optionalVazio** est√° realmente vazio, com o M√©todo **get()** acessamos o conte√∫do do Optional **valor_indice_02**  e com o M√©todo **isPresent()** verificamos se o Optional **valor_indice_02** possui um Objeto n√£o nulo.

<br />

<div align="left"><img src="https://i.imgur.com/bQGvf3h.png" title="source: imgur.com" width="25px"/> <a href="https://github.com/rafaelq80/exemplos_java/tree/main/java_optional/optional02" target="_blank"><b>C√≥digo fonte do exemplo</b></a></div>

<br />

## <img src="https://i.imgur.com/gsSDe7P.png" title="source: imgur.com" width="3%"/>Exemplo 04 - Optional  - M√©todos II

No exemplo abaixo vamos utilizar a Classe **Colaborador** e utilizar os M√©todos **map(), filter() e orElseThrow()** da Classe **Optional**, em conjunto com uma **Express√£o Lambda** para fazer uma busca:

**Classe Colaborador**

```java
package com.generation.optional03.model;

public class Colaborador {

	private Long id;
	private String nome;
	private Float salario;
	
	public Colaborador(Long id, String nome, Float salario) {
		this.id = id;
		this.nome = nome;
		this.salario = salario;
	}
	
	public Long getId() {
		return id;
	}
	public void setId(Long id) {
		this.id = id;
	}
	public String getNome() {
		return nome;
	}
	public void setNome(String nome) {
		this.nome = nome;
	}
	public Float getSalario() {
		return salario;
	}
	public void setSalario(Float salario) {
		this.salario = salario;
	}
	
}

```

**Classe Optional03**

```java
package com.generation.optional03;

import java.util.Optional;

import com.generation.optional03.model.Colaborador;

public class Optional03 {

	public static void main(String[] args) {
				
		Colaborador c1 = new Colaborador(1L, "James Bond", 1000.0f);
		
	    Optional<Colaborador> colaboradorOptional = Optional.of(c1);
	    
	    colaboradorOptional.map(resposta -> resposta.getNome())
	    		.filter(colaboradorNome -> colaboradorNome.startsWith("J"))
	    		.orElseThrow(() -> new RuntimeException("Colaborador n√£o encontrado!"));
	                                                    
	    System.out.println("\nNome do Colaborador: " + colaboradorOptional.get().getNome());
	    
	}

}

```

No console ser√° exibida a mensagem abaixo:

<img src="https://i.imgur.com/V2ReOnx.png" title="source: imgur.com" width="3%"/>**Resultado do Algoritmo:**

```java
Nome do Colaborador: James Bond
```

Observe que atrav√©s do M√©todo **map()**, criamos um la√ßo condicional, onde se as condi√ß√µes forem satisfeitas, ou seja, o Objeto c1, que est√° encapsulado no Objeto Optional **colaboradorOptional**, corresponder as condi√ß√µes estabelecidas no M√©todo **filter()**, ser√° exibido o nome do Colaborador atrav√©s do M√©todo **getNome()**, da Classe **Colaborador**. Caso contr√°rio, ser√° lan√ßada uma Exce√ß√£o do tipo `RuntimeException` contendo a mensagem: *"Colaborador n√£o encontrado!"*. 

O M√©todo **filter()**, define as condi√ß√µes para que o Atributo nome do colaborador do Objeto c1 seja exibido na tela. No exemplo acima, o nome deve iniciar com a letra ***J***. Para testar esta condi√ß√£o, foi utilizado o M√©todo **startsWith()**, da Classe String.

Para finalizar o m√©todo map(), o M√©todo **orElseThrow()** lan√ßa a Exce√ß√£o do tipo `RuntimeException`, caso o Objeto n√£o corresponda a condi√ß√£o do M√©todo **filter()**.

Observe que para exibir no console o nome do Colaborador, √© necess√°rio utilizar o M√©todo **get()** para acessar o Objeto **c1**, que est√° encapsulado dentro do Objeto **colaboradorOptional**, para conseguir executar o M√©todo **getNome()**, da Classe Colaborador. Por isso que descrevemos o Optional como uma caixa, que encapsula um Objeto.

> **Express√µes Lambda:** Express√£o Lambda √© uma  fun√ß√£o sem uma classe, ent√£o a palavra-chave "this" n√£o se refere a  pr√≥pria lambda, mas sim a classe na qual foi declarada. Isso distingue de uma classe interna an√¥nima, na qual "this" refere-se a pr√≥pria classe interna.

<br />

<div align="left"><img src="https://i.imgur.com/bQGvf3h.png" title="source: imgur.com" width="25px"/> <a href="https://github.com/rafaelq80/exemplos_java/tree/main/java_optional/optional03" target="_blank"><b>C√≥digo fonte do exemplo</b></a></div>

<br />

------

## üîë**Pontos chave:**

1. **Optional** √© uma classe que foi implementada no **Java** 8+, que tem o objetivo de simplificar os c√≥digos, facilitando a vida dos desenvolvedores. 
2. O **Optional** nos ajuda a evitar os erros *NullPointerException*, elimina a necessidade da verifica√ß√£o (if x != null) e tamb√©m a escreve um c√≥digo com menos linhas e mais limpo.

<br /><br />

<div align="left"><a href="README.md"><img src="https://i.imgur.com/XMgF3gl.png" title="source: imgur.com" width="3%"/>Voltar</a></div>	